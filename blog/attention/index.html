<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><meta name="generator" content="Gatsby 5.13.7"/><meta name="description" content="Attention in machine learning is like the brain&#x27;s spotlight, highlighting important parts of data. Introduced in 2014, it focuses on relevant information using &quot;queries,&quot; &quot;keys,&quot; and &quot;values.&quot; Imagine a model yelling, &quot;Hey, brain, remember that detail!&quot; to handle complex tasks like translating long sentences." data-gatsby-head="true"/><meta name="image" content="https://robaita.comsrc/assets/images/robaita.PNG" data-gatsby-head="true"/><meta property="og:title" content="Attention Please! | Robaita" data-gatsby-head="true"/><meta property="og:url" content="https://robaita.com/blog/attention" data-gatsby-head="true"/><meta property="og:description" content="Attention in machine learning is like the brain&#x27;s spotlight, highlighting important parts of data. Introduced in 2014, it focuses on relevant information using &quot;queries,&quot; &quot;keys,&quot; and &quot;values.&quot; Imagine a model yelling, &quot;Hey, brain, remember that detail!&quot; to handle complex tasks like translating long sentences." data-gatsby-head="true"/><meta property="og:image" content="https://robaita.comsrc/assets/images/robaita.PNG" data-gatsby-head="true"/><meta property="og:type" content="website" data-gatsby-head="true"/><meta property="og:image:alt" content="Attention in machine learning is like the brain&#x27;s spotlight, highlighting important parts of data. Introduced in 2014, it focuses on relevant information using &quot;queries,&quot; &quot;keys,&quot; and &quot;values.&quot; Imagine a model yelling, &quot;Hey, brain, remember that detail!&quot; to handle complex tasks like translating long sentences." data-gatsby-head="true"/><meta name="twitter:card" content="summary_large_image" data-gatsby-head="true"/><meta name="twitter:title" content="Attention Please! | Robaita" data-gatsby-head="true"/><meta name="twitter:url" content="https://robaita.com/blog/attention" data-gatsby-head="true"/><meta name="twitter:description" content="Attention in machine learning is like the brain&#x27;s spotlight, highlighting important parts of data. Introduced in 2014, it focuses on relevant information using &quot;queries,&quot; &quot;keys,&quot; and &quot;values.&quot; Imagine a model yelling, &quot;Hey, brain, remember that detail!&quot; to handle complex tasks like translating long sentences." data-gatsby-head="true"/><meta name="twitter:image" content="https://robaita.comsrc/assets/images/robaita.PNG" data-gatsby-head="true"/><meta name="twitter:image:alt" content="Attention in machine learning is like the brain&#x27;s spotlight, highlighting important parts of data. Introduced in 2014, it focuses on relevant information using &quot;queries,&quot; &quot;keys,&quot; and &quot;values.&quot; Imagine a model yelling, &quot;Hey, brain, remember that detail!&quot; to handle complex tasks like translating long sentences." data-gatsby-head="true"/><meta name="twitter:creator" content="Dr. Avinash Kumar Singh" data-gatsby-head="true"/><meta name="gatsby-theme" content="@lekoarts/gatsby-theme-minimal-blog" data-gatsby-head="true"/><link rel="sitemap" type="application/xml" href="/sitemap-index.xml"/><link rel="manifest" href="/manifest.webmanifest" crossorigin="anonymous"/><link rel="apple-touch-icon" sizes="192x192" href="/android-chrome-192x192.png"/><link rel="apple-touch-icon" sizes="512x512" href="/android-chrome-512x512.png"/><link rel="alternate" type="application/rss+xml" title="Minimal Blog - @lekoarts/gatsby-theme-minimal-blog" href="/rss.xml"/><style data-emotion="css-global 6koz1s" data-gatsby-head="true">html{--theme-ui-colors-transparent:transparent;--theme-ui-colors-black:#000;--theme-ui-colors-white:#fff;--theme-ui-colors-gray-1:#f7fafc;--theme-ui-colors-gray-2:#edf2f7;--theme-ui-colors-gray-3:#e2e8f0;--theme-ui-colors-gray-4:#cbd5e0;--theme-ui-colors-gray-5:#a0aec0;--theme-ui-colors-gray-6:#718096;--theme-ui-colors-gray-7:#4a5568;--theme-ui-colors-gray-8:#2d3748;--theme-ui-colors-gray-9:#1a202c;--theme-ui-colors-red-1:#fff5f5;--theme-ui-colors-red-2:#fed7d7;--theme-ui-colors-red-3:#feb2b2;--theme-ui-colors-red-4:#fc8181;--theme-ui-colors-red-5:#f56565;--theme-ui-colors-red-6:#e53e3e;--theme-ui-colors-red-7:#c53030;--theme-ui-colors-red-8:#9b2c2c;--theme-ui-colors-red-9:#742a2a;--theme-ui-colors-orange-1:#fffaf0;--theme-ui-colors-orange-2:#feebc8;--theme-ui-colors-orange-3:#fbd38d;--theme-ui-colors-orange-4:#f6ad55;--theme-ui-colors-orange-5:#ed8936;--theme-ui-colors-orange-6:#dd6b20;--theme-ui-colors-orange-7:#c05621;--theme-ui-colors-orange-8:#9c4221;--theme-ui-colors-orange-9:#7b341e;--theme-ui-colors-yellow-1:#fffff0;--theme-ui-colors-yellow-2:#fefcbf;--theme-ui-colors-yellow-3:#faf089;--theme-ui-colors-yellow-4:#f6e05e;--theme-ui-colors-yellow-5:#ecc94b;--theme-ui-colors-yellow-6:#d69e2e;--theme-ui-colors-yellow-7:#b7791f;--theme-ui-colors-yellow-8:#975a16;--theme-ui-colors-yellow-9:#744210;--theme-ui-colors-green-1:#f0fff4;--theme-ui-colors-green-2:#c6f6d5;--theme-ui-colors-green-3:#9ae6b4;--theme-ui-colors-green-4:#68d391;--theme-ui-colors-green-5:#48bb78;--theme-ui-colors-green-6:#38a169;--theme-ui-colors-green-7:#2f855a;--theme-ui-colors-green-8:#276749;--theme-ui-colors-green-9:#22543d;--theme-ui-colors-teal-1:#e6fffa;--theme-ui-colors-teal-2:#b2f5ea;--theme-ui-colors-teal-3:#81e6d9;--theme-ui-colors-teal-4:#4fd1c5;--theme-ui-colors-teal-5:#38b2ac;--theme-ui-colors-teal-6:#319795;--theme-ui-colors-teal-7:#2c7a7b;--theme-ui-colors-teal-8:#285e61;--theme-ui-colors-teal-9:#234e52;--theme-ui-colors-blue-1:#ebf8ff;--theme-ui-colors-blue-2:#bee3f8;--theme-ui-colors-blue-3:#90cdf4;--theme-ui-colors-blue-4:#63b3ed;--theme-ui-colors-blue-5:#4299e1;--theme-ui-colors-blue-6:#3182ce;--theme-ui-colors-blue-7:#2b6cb0;--theme-ui-colors-blue-8:#2c5282;--theme-ui-colors-blue-9:#2a4365;--theme-ui-colors-indigo-1:#ebf4ff;--theme-ui-colors-indigo-2:#c3dafe;--theme-ui-colors-indigo-3:#a3bffa;--theme-ui-colors-indigo-4:#7f9cf5;--theme-ui-colors-indigo-5:#667eea;--theme-ui-colors-indigo-6:#5a67d8;--theme-ui-colors-indigo-7:#4c51bf;--theme-ui-colors-indigo-8:#434190;--theme-ui-colors-indigo-9:#3c366b;--theme-ui-colors-purple-1:#faf5ff;--theme-ui-colors-purple-2:#e9d8fd;--theme-ui-colors-purple-3:#d6bcfa;--theme-ui-colors-purple-4:#b794f4;--theme-ui-colors-purple-5:#9f7aea;--theme-ui-colors-purple-6:#805ad5;--theme-ui-colors-purple-7:#6b46c1;--theme-ui-colors-purple-8:#553c9a;--theme-ui-colors-purple-9:#44337a;--theme-ui-colors-pink-1:#fff5f7;--theme-ui-colors-pink-2:#fed7e2;--theme-ui-colors-pink-3:#fbb6ce;--theme-ui-colors-pink-4:#f687b3;--theme-ui-colors-pink-5:#ed64a6;--theme-ui-colors-pink-6:#d53f8c;--theme-ui-colors-pink-7:#b83280;--theme-ui-colors-pink-8:#97266d;--theme-ui-colors-pink-9:#702459;--theme-ui-colors-grayDark:#2d3748;--theme-ui-colors-text:#2d3748;--theme-ui-colors-background:#fff;--theme-ui-colors-primary:#6b46c1;--theme-ui-colors-primaryHover:#2c5282;--theme-ui-colors-secondary:#5f6c80;--theme-ui-colors-muted:#edf2f7;--theme-ui-colors-success:#9ae6b4;--theme-ui-colors-info:#63b3ed;--theme-ui-colors-warning:#faf089;--theme-ui-colors-danger:#feb2b2;--theme-ui-colors-light:#f7fafc;--theme-ui-colors-dark:#2d3748;--theme-ui-colors-textMuted:#718096;--theme-ui-colors-toggleIcon:#2d3748;--theme-ui-colors-heading:#000;--theme-ui-colors-divide:#cbd5e0;--theme-ui-colors-highlightLineBg:rgba(0, 0, 0, 0.035);--theme-ui-colors-plain-color:#393A34;--theme-ui-colors-plain-backgroundColor:#f6f8fa;--theme-ui-colors-comment-color:#999988;--theme-ui-colors-comment-fontStyle:italic;--theme-ui-colors-prolog-color:#999988;--theme-ui-colors-prolog-fontStyle:italic;--theme-ui-colors-doctype-color:#999988;--theme-ui-colors-doctype-fontStyle:italic;--theme-ui-colors-cdata-color:#999988;--theme-ui-colors-cdata-fontStyle:italic;--theme-ui-colors-namespace-opacity:0.7;--theme-ui-colors-string-color:#e3116c;--theme-ui-colors-attr-value-color:#e3116c;--theme-ui-colors-punctuation-color:#393A34;--theme-ui-colors-operator-color:#393A34;--theme-ui-colors-entity-color:#36acaa;--theme-ui-colors-url-color:#36acaa;--theme-ui-colors-symbol-color:#36acaa;--theme-ui-colors-number-color:#36acaa;--theme-ui-colors-boolean-color:#36acaa;--theme-ui-colors-variable-color:#36acaa;--theme-ui-colors-constant-color:#36acaa;--theme-ui-colors-property-color:#36acaa;--theme-ui-colors-regex-color:#36acaa;--theme-ui-colors-inserted-color:#36acaa;--theme-ui-colors-atrule-color:#00a4db;--theme-ui-colors-keyword-color:#00009f;--theme-ui-colors-attr-name-color:#00a4db;--theme-ui-colors-selector-color:#00009f;--theme-ui-colors-function-color:#d73a49;--theme-ui-colors-deleted-color:#d73a49;--theme-ui-colors-tag-color:#00009f;--theme-ui-colors-function-variable-color:#6f42c1;color:var(--theme-ui-colors-text);background-color:var(--theme-ui-colors-background);}html.theme-ui-light,.theme-ui-light html{--theme-ui-colors-transparent:transparent;--theme-ui-colors-black:#000;--theme-ui-colors-white:#fff;--theme-ui-colors-gray-1:#f7fafc;--theme-ui-colors-gray-2:#edf2f7;--theme-ui-colors-gray-3:#e2e8f0;--theme-ui-colors-gray-4:#cbd5e0;--theme-ui-colors-gray-5:#a0aec0;--theme-ui-colors-gray-6:#718096;--theme-ui-colors-gray-7:#4a5568;--theme-ui-colors-gray-8:#2d3748;--theme-ui-colors-gray-9:#1a202c;--theme-ui-colors-red-1:#fff5f5;--theme-ui-colors-red-2:#fed7d7;--theme-ui-colors-red-3:#feb2b2;--theme-ui-colors-red-4:#fc8181;--theme-ui-colors-red-5:#f56565;--theme-ui-colors-red-6:#e53e3e;--theme-ui-colors-red-7:#c53030;--theme-ui-colors-red-8:#9b2c2c;--theme-ui-colors-red-9:#742a2a;--theme-ui-colors-orange-1:#fffaf0;--theme-ui-colors-orange-2:#feebc8;--theme-ui-colors-orange-3:#fbd38d;--theme-ui-colors-orange-4:#f6ad55;--theme-ui-colors-orange-5:#ed8936;--theme-ui-colors-orange-6:#dd6b20;--theme-ui-colors-orange-7:#c05621;--theme-ui-colors-orange-8:#9c4221;--theme-ui-colors-orange-9:#7b341e;--theme-ui-colors-yellow-1:#fffff0;--theme-ui-colors-yellow-2:#fefcbf;--theme-ui-colors-yellow-3:#faf089;--theme-ui-colors-yellow-4:#f6e05e;--theme-ui-colors-yellow-5:#ecc94b;--theme-ui-colors-yellow-6:#d69e2e;--theme-ui-colors-yellow-7:#b7791f;--theme-ui-colors-yellow-8:#975a16;--theme-ui-colors-yellow-9:#744210;--theme-ui-colors-green-1:#f0fff4;--theme-ui-colors-green-2:#c6f6d5;--theme-ui-colors-green-3:#9ae6b4;--theme-ui-colors-green-4:#68d391;--theme-ui-colors-green-5:#48bb78;--theme-ui-colors-green-6:#38a169;--theme-ui-colors-green-7:#2f855a;--theme-ui-colors-green-8:#276749;--theme-ui-colors-green-9:#22543d;--theme-ui-colors-teal-1:#e6fffa;--theme-ui-colors-teal-2:#b2f5ea;--theme-ui-colors-teal-3:#81e6d9;--theme-ui-colors-teal-4:#4fd1c5;--theme-ui-colors-teal-5:#38b2ac;--theme-ui-colors-teal-6:#319795;--theme-ui-colors-teal-7:#2c7a7b;--theme-ui-colors-teal-8:#285e61;--theme-ui-colors-teal-9:#234e52;--theme-ui-colors-blue-1:#ebf8ff;--theme-ui-colors-blue-2:#bee3f8;--theme-ui-colors-blue-3:#90cdf4;--theme-ui-colors-blue-4:#63b3ed;--theme-ui-colors-blue-5:#4299e1;--theme-ui-colors-blue-6:#3182ce;--theme-ui-colors-blue-7:#2b6cb0;--theme-ui-colors-blue-8:#2c5282;--theme-ui-colors-blue-9:#2a4365;--theme-ui-colors-indigo-1:#ebf4ff;--theme-ui-colors-indigo-2:#c3dafe;--theme-ui-colors-indigo-3:#a3bffa;--theme-ui-colors-indigo-4:#7f9cf5;--theme-ui-colors-indigo-5:#667eea;--theme-ui-colors-indigo-6:#5a67d8;--theme-ui-colors-indigo-7:#4c51bf;--theme-ui-colors-indigo-8:#434190;--theme-ui-colors-indigo-9:#3c366b;--theme-ui-colors-purple-1:#faf5ff;--theme-ui-colors-purple-2:#e9d8fd;--theme-ui-colors-purple-3:#d6bcfa;--theme-ui-colors-purple-4:#b794f4;--theme-ui-colors-purple-5:#9f7aea;--theme-ui-colors-purple-6:#805ad5;--theme-ui-colors-purple-7:#6b46c1;--theme-ui-colors-purple-8:#553c9a;--theme-ui-colors-purple-9:#44337a;--theme-ui-colors-pink-1:#fff5f7;--theme-ui-colors-pink-2:#fed7e2;--theme-ui-colors-pink-3:#fbb6ce;--theme-ui-colors-pink-4:#f687b3;--theme-ui-colors-pink-5:#ed64a6;--theme-ui-colors-pink-6:#d53f8c;--theme-ui-colors-pink-7:#b83280;--theme-ui-colors-pink-8:#97266d;--theme-ui-colors-pink-9:#702459;--theme-ui-colors-grayDark:#2d3748;--theme-ui-colors-text:#2d3748;--theme-ui-colors-background:#fff;--theme-ui-colors-primary:#6b46c1;--theme-ui-colors-primaryHover:#2c5282;--theme-ui-colors-secondary:#5f6c80;--theme-ui-colors-muted:#edf2f7;--theme-ui-colors-success:#9ae6b4;--theme-ui-colors-info:#63b3ed;--theme-ui-colors-warning:#faf089;--theme-ui-colors-danger:#feb2b2;--theme-ui-colors-light:#f7fafc;--theme-ui-colors-dark:#2d3748;--theme-ui-colors-textMuted:#718096;--theme-ui-colors-toggleIcon:#2d3748;--theme-ui-colors-heading:#000;--theme-ui-colors-divide:#cbd5e0;--theme-ui-colors-highlightLineBg:rgba(0, 0, 0, 0.035);--theme-ui-colors-plain-color:#393A34;--theme-ui-colors-plain-backgroundColor:#f6f8fa;--theme-ui-colors-comment-color:#999988;--theme-ui-colors-comment-fontStyle:italic;--theme-ui-colors-prolog-color:#999988;--theme-ui-colors-prolog-fontStyle:italic;--theme-ui-colors-doctype-color:#999988;--theme-ui-colors-doctype-fontStyle:italic;--theme-ui-colors-cdata-color:#999988;--theme-ui-colors-cdata-fontStyle:italic;--theme-ui-colors-namespace-opacity:0.7;--theme-ui-colors-string-color:#e3116c;--theme-ui-colors-attr-value-color:#e3116c;--theme-ui-colors-punctuation-color:#393A34;--theme-ui-colors-operator-color:#393A34;--theme-ui-colors-entity-color:#36acaa;--theme-ui-colors-url-color:#36acaa;--theme-ui-colors-symbol-color:#36acaa;--theme-ui-colors-number-color:#36acaa;--theme-ui-colors-boolean-color:#36acaa;--theme-ui-colors-variable-color:#36acaa;--theme-ui-colors-constant-color:#36acaa;--theme-ui-colors-property-color:#36acaa;--theme-ui-colors-regex-color:#36acaa;--theme-ui-colors-inserted-color:#36acaa;--theme-ui-colors-atrule-color:#00a4db;--theme-ui-colors-keyword-color:#00009f;--theme-ui-colors-attr-name-color:#00a4db;--theme-ui-colors-selector-color:#00009f;--theme-ui-colors-function-color:#d73a49;--theme-ui-colors-deleted-color:#d73a49;--theme-ui-colors-tag-color:#00009f;--theme-ui-colors-function-variable-color:#6f42c1;}html.theme-ui-dark,.theme-ui-dark html{--theme-ui-colors-text:#cbd5e0;--theme-ui-colors-primary:#b794f4;--theme-ui-colors-secondary:#8a9ab0;--theme-ui-colors-toggleIcon:#cbd5e0;--theme-ui-colors-background:#1A202C;--theme-ui-colors-heading:#fff;--theme-ui-colors-divide:#2d3748;--theme-ui-colors-muted:#2d3748;--theme-ui-colors-highlightLineBg:rgba(255, 255, 255, 0.1);--theme-ui-colors-plain-color:#9CDCFE;--theme-ui-colors-plain-backgroundColor:#1E1E1E;--theme-ui-colors-prolog-color:rgb(0, 0, 128);--theme-ui-colors-comment-color:rgb(106, 153, 85);--theme-ui-colors-builtin-color:rgb(86, 156, 214);--theme-ui-colors-changed-color:rgb(86, 156, 214);--theme-ui-colors-keyword-color:rgb(86, 156, 214);--theme-ui-colors-interpolation-punctuation-color:rgb(86, 156, 214);--theme-ui-colors-number-color:rgb(181, 206, 168);--theme-ui-colors-inserted-color:rgb(181, 206, 168);--theme-ui-colors-constant-color:rgb(100, 102, 149);--theme-ui-colors-attr-name-color:rgb(156, 220, 254);--theme-ui-colors-variable-color:rgb(156, 220, 254);--theme-ui-colors-deleted-color:rgb(206, 145, 120);--theme-ui-colors-string-color:rgb(206, 145, 120);--theme-ui-colors-attr-value-color:rgb(206, 145, 120);--theme-ui-colors-template-punctuation-color:rgb(206, 145, 120);--theme-ui-colors-selector-color:rgb(215, 186, 125);--theme-ui-colors-tag-color:rgb(86, 156, 214);--theme-ui-colors-punctuation-color:#808080;--theme-ui-colors-operator-color:rgb(212, 212, 212);--theme-ui-colors-function-color:rgb(220, 220, 170);--theme-ui-colors-class-name-color:rgb(78, 201, 176);--theme-ui-colors-char-color:rgb(209, 105, 105);}</style><style data-emotion="css-global 1mawjxo" data-gatsby-head="true">*{box-sizing:border-box;}html{font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";line-height:1.625;font-weight:400;color:var(--theme-ui-colors-text);background-color:var(--theme-ui-colors-background);margin:0;padding:0;box-sizing:border-box;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;-webkit-text-size-adjust:100%;}html img{border-style:none;}html pre{font-family:Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;}html a{-webkit-transition:all 0.3s ease-in-out;transition:all 0.3s ease-in-out;color:var(--theme-ui-colors-text);}body{margin:0;}</style><title data-gatsby-head="true">Attention Please! | Robaita</title><link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png" data-gatsby-head="true"/><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png" data-gatsby-head="true"/><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" data-gatsby-head="true"/></head><body><script>(function() { try {
  var mode = localStorage.getItem('theme-ui-color-mode');
  if (!mode) return
  document.documentElement.classList.add('theme-ui-' + mode);
} catch (e) {} })();</script><div id="___gatsby"><style data-emotion="css-global 6koz1s">html{--theme-ui-colors-transparent:transparent;--theme-ui-colors-black:#000;--theme-ui-colors-white:#fff;--theme-ui-colors-gray-1:#f7fafc;--theme-ui-colors-gray-2:#edf2f7;--theme-ui-colors-gray-3:#e2e8f0;--theme-ui-colors-gray-4:#cbd5e0;--theme-ui-colors-gray-5:#a0aec0;--theme-ui-colors-gray-6:#718096;--theme-ui-colors-gray-7:#4a5568;--theme-ui-colors-gray-8:#2d3748;--theme-ui-colors-gray-9:#1a202c;--theme-ui-colors-red-1:#fff5f5;--theme-ui-colors-red-2:#fed7d7;--theme-ui-colors-red-3:#feb2b2;--theme-ui-colors-red-4:#fc8181;--theme-ui-colors-red-5:#f56565;--theme-ui-colors-red-6:#e53e3e;--theme-ui-colors-red-7:#c53030;--theme-ui-colors-red-8:#9b2c2c;--theme-ui-colors-red-9:#742a2a;--theme-ui-colors-orange-1:#fffaf0;--theme-ui-colors-orange-2:#feebc8;--theme-ui-colors-orange-3:#fbd38d;--theme-ui-colors-orange-4:#f6ad55;--theme-ui-colors-orange-5:#ed8936;--theme-ui-colors-orange-6:#dd6b20;--theme-ui-colors-orange-7:#c05621;--theme-ui-colors-orange-8:#9c4221;--theme-ui-colors-orange-9:#7b341e;--theme-ui-colors-yellow-1:#fffff0;--theme-ui-colors-yellow-2:#fefcbf;--theme-ui-colors-yellow-3:#faf089;--theme-ui-colors-yellow-4:#f6e05e;--theme-ui-colors-yellow-5:#ecc94b;--theme-ui-colors-yellow-6:#d69e2e;--theme-ui-colors-yellow-7:#b7791f;--theme-ui-colors-yellow-8:#975a16;--theme-ui-colors-yellow-9:#744210;--theme-ui-colors-green-1:#f0fff4;--theme-ui-colors-green-2:#c6f6d5;--theme-ui-colors-green-3:#9ae6b4;--theme-ui-colors-green-4:#68d391;--theme-ui-colors-green-5:#48bb78;--theme-ui-colors-green-6:#38a169;--theme-ui-colors-green-7:#2f855a;--theme-ui-colors-green-8:#276749;--theme-ui-colors-green-9:#22543d;--theme-ui-colors-teal-1:#e6fffa;--theme-ui-colors-teal-2:#b2f5ea;--theme-ui-colors-teal-3:#81e6d9;--theme-ui-colors-teal-4:#4fd1c5;--theme-ui-colors-teal-5:#38b2ac;--theme-ui-colors-teal-6:#319795;--theme-ui-colors-teal-7:#2c7a7b;--theme-ui-colors-teal-8:#285e61;--theme-ui-colors-teal-9:#234e52;--theme-ui-colors-blue-1:#ebf8ff;--theme-ui-colors-blue-2:#bee3f8;--theme-ui-colors-blue-3:#90cdf4;--theme-ui-colors-blue-4:#63b3ed;--theme-ui-colors-blue-5:#4299e1;--theme-ui-colors-blue-6:#3182ce;--theme-ui-colors-blue-7:#2b6cb0;--theme-ui-colors-blue-8:#2c5282;--theme-ui-colors-blue-9:#2a4365;--theme-ui-colors-indigo-1:#ebf4ff;--theme-ui-colors-indigo-2:#c3dafe;--theme-ui-colors-indigo-3:#a3bffa;--theme-ui-colors-indigo-4:#7f9cf5;--theme-ui-colors-indigo-5:#667eea;--theme-ui-colors-indigo-6:#5a67d8;--theme-ui-colors-indigo-7:#4c51bf;--theme-ui-colors-indigo-8:#434190;--theme-ui-colors-indigo-9:#3c366b;--theme-ui-colors-purple-1:#faf5ff;--theme-ui-colors-purple-2:#e9d8fd;--theme-ui-colors-purple-3:#d6bcfa;--theme-ui-colors-purple-4:#b794f4;--theme-ui-colors-purple-5:#9f7aea;--theme-ui-colors-purple-6:#805ad5;--theme-ui-colors-purple-7:#6b46c1;--theme-ui-colors-purple-8:#553c9a;--theme-ui-colors-purple-9:#44337a;--theme-ui-colors-pink-1:#fff5f7;--theme-ui-colors-pink-2:#fed7e2;--theme-ui-colors-pink-3:#fbb6ce;--theme-ui-colors-pink-4:#f687b3;--theme-ui-colors-pink-5:#ed64a6;--theme-ui-colors-pink-6:#d53f8c;--theme-ui-colors-pink-7:#b83280;--theme-ui-colors-pink-8:#97266d;--theme-ui-colors-pink-9:#702459;--theme-ui-colors-grayDark:#2d3748;--theme-ui-colors-text:#2d3748;--theme-ui-colors-background:#fff;--theme-ui-colors-primary:#6b46c1;--theme-ui-colors-primaryHover:#2c5282;--theme-ui-colors-secondary:#5f6c80;--theme-ui-colors-muted:#edf2f7;--theme-ui-colors-success:#9ae6b4;--theme-ui-colors-info:#63b3ed;--theme-ui-colors-warning:#faf089;--theme-ui-colors-danger:#feb2b2;--theme-ui-colors-light:#f7fafc;--theme-ui-colors-dark:#2d3748;--theme-ui-colors-textMuted:#718096;--theme-ui-colors-toggleIcon:#2d3748;--theme-ui-colors-heading:#000;--theme-ui-colors-divide:#cbd5e0;--theme-ui-colors-highlightLineBg:rgba(0, 0, 0, 0.035);--theme-ui-colors-plain-color:#393A34;--theme-ui-colors-plain-backgroundColor:#f6f8fa;--theme-ui-colors-comment-color:#999988;--theme-ui-colors-comment-fontStyle:italic;--theme-ui-colors-prolog-color:#999988;--theme-ui-colors-prolog-fontStyle:italic;--theme-ui-colors-doctype-color:#999988;--theme-ui-colors-doctype-fontStyle:italic;--theme-ui-colors-cdata-color:#999988;--theme-ui-colors-cdata-fontStyle:italic;--theme-ui-colors-namespace-opacity:0.7;--theme-ui-colors-string-color:#e3116c;--theme-ui-colors-attr-value-color:#e3116c;--theme-ui-colors-punctuation-color:#393A34;--theme-ui-colors-operator-color:#393A34;--theme-ui-colors-entity-color:#36acaa;--theme-ui-colors-url-color:#36acaa;--theme-ui-colors-symbol-color:#36acaa;--theme-ui-colors-number-color:#36acaa;--theme-ui-colors-boolean-color:#36acaa;--theme-ui-colors-variable-color:#36acaa;--theme-ui-colors-constant-color:#36acaa;--theme-ui-colors-property-color:#36acaa;--theme-ui-colors-regex-color:#36acaa;--theme-ui-colors-inserted-color:#36acaa;--theme-ui-colors-atrule-color:#00a4db;--theme-ui-colors-keyword-color:#00009f;--theme-ui-colors-attr-name-color:#00a4db;--theme-ui-colors-selector-color:#00009f;--theme-ui-colors-function-color:#d73a49;--theme-ui-colors-deleted-color:#d73a49;--theme-ui-colors-tag-color:#00009f;--theme-ui-colors-function-variable-color:#6f42c1;color:var(--theme-ui-colors-text);background-color:var(--theme-ui-colors-background);}html.theme-ui-light,.theme-ui-light html{--theme-ui-colors-transparent:transparent;--theme-ui-colors-black:#000;--theme-ui-colors-white:#fff;--theme-ui-colors-gray-1:#f7fafc;--theme-ui-colors-gray-2:#edf2f7;--theme-ui-colors-gray-3:#e2e8f0;--theme-ui-colors-gray-4:#cbd5e0;--theme-ui-colors-gray-5:#a0aec0;--theme-ui-colors-gray-6:#718096;--theme-ui-colors-gray-7:#4a5568;--theme-ui-colors-gray-8:#2d3748;--theme-ui-colors-gray-9:#1a202c;--theme-ui-colors-red-1:#fff5f5;--theme-ui-colors-red-2:#fed7d7;--theme-ui-colors-red-3:#feb2b2;--theme-ui-colors-red-4:#fc8181;--theme-ui-colors-red-5:#f56565;--theme-ui-colors-red-6:#e53e3e;--theme-ui-colors-red-7:#c53030;--theme-ui-colors-red-8:#9b2c2c;--theme-ui-colors-red-9:#742a2a;--theme-ui-colors-orange-1:#fffaf0;--theme-ui-colors-orange-2:#feebc8;--theme-ui-colors-orange-3:#fbd38d;--theme-ui-colors-orange-4:#f6ad55;--theme-ui-colors-orange-5:#ed8936;--theme-ui-colors-orange-6:#dd6b20;--theme-ui-colors-orange-7:#c05621;--theme-ui-colors-orange-8:#9c4221;--theme-ui-colors-orange-9:#7b341e;--theme-ui-colors-yellow-1:#fffff0;--theme-ui-colors-yellow-2:#fefcbf;--theme-ui-colors-yellow-3:#faf089;--theme-ui-colors-yellow-4:#f6e05e;--theme-ui-colors-yellow-5:#ecc94b;--theme-ui-colors-yellow-6:#d69e2e;--theme-ui-colors-yellow-7:#b7791f;--theme-ui-colors-yellow-8:#975a16;--theme-ui-colors-yellow-9:#744210;--theme-ui-colors-green-1:#f0fff4;--theme-ui-colors-green-2:#c6f6d5;--theme-ui-colors-green-3:#9ae6b4;--theme-ui-colors-green-4:#68d391;--theme-ui-colors-green-5:#48bb78;--theme-ui-colors-green-6:#38a169;--theme-ui-colors-green-7:#2f855a;--theme-ui-colors-green-8:#276749;--theme-ui-colors-green-9:#22543d;--theme-ui-colors-teal-1:#e6fffa;--theme-ui-colors-teal-2:#b2f5ea;--theme-ui-colors-teal-3:#81e6d9;--theme-ui-colors-teal-4:#4fd1c5;--theme-ui-colors-teal-5:#38b2ac;--theme-ui-colors-teal-6:#319795;--theme-ui-colors-teal-7:#2c7a7b;--theme-ui-colors-teal-8:#285e61;--theme-ui-colors-teal-9:#234e52;--theme-ui-colors-blue-1:#ebf8ff;--theme-ui-colors-blue-2:#bee3f8;--theme-ui-colors-blue-3:#90cdf4;--theme-ui-colors-blue-4:#63b3ed;--theme-ui-colors-blue-5:#4299e1;--theme-ui-colors-blue-6:#3182ce;--theme-ui-colors-blue-7:#2b6cb0;--theme-ui-colors-blue-8:#2c5282;--theme-ui-colors-blue-9:#2a4365;--theme-ui-colors-indigo-1:#ebf4ff;--theme-ui-colors-indigo-2:#c3dafe;--theme-ui-colors-indigo-3:#a3bffa;--theme-ui-colors-indigo-4:#7f9cf5;--theme-ui-colors-indigo-5:#667eea;--theme-ui-colors-indigo-6:#5a67d8;--theme-ui-colors-indigo-7:#4c51bf;--theme-ui-colors-indigo-8:#434190;--theme-ui-colors-indigo-9:#3c366b;--theme-ui-colors-purple-1:#faf5ff;--theme-ui-colors-purple-2:#e9d8fd;--theme-ui-colors-purple-3:#d6bcfa;--theme-ui-colors-purple-4:#b794f4;--theme-ui-colors-purple-5:#9f7aea;--theme-ui-colors-purple-6:#805ad5;--theme-ui-colors-purple-7:#6b46c1;--theme-ui-colors-purple-8:#553c9a;--theme-ui-colors-purple-9:#44337a;--theme-ui-colors-pink-1:#fff5f7;--theme-ui-colors-pink-2:#fed7e2;--theme-ui-colors-pink-3:#fbb6ce;--theme-ui-colors-pink-4:#f687b3;--theme-ui-colors-pink-5:#ed64a6;--theme-ui-colors-pink-6:#d53f8c;--theme-ui-colors-pink-7:#b83280;--theme-ui-colors-pink-8:#97266d;--theme-ui-colors-pink-9:#702459;--theme-ui-colors-grayDark:#2d3748;--theme-ui-colors-text:#2d3748;--theme-ui-colors-background:#fff;--theme-ui-colors-primary:#6b46c1;--theme-ui-colors-primaryHover:#2c5282;--theme-ui-colors-secondary:#5f6c80;--theme-ui-colors-muted:#edf2f7;--theme-ui-colors-success:#9ae6b4;--theme-ui-colors-info:#63b3ed;--theme-ui-colors-warning:#faf089;--theme-ui-colors-danger:#feb2b2;--theme-ui-colors-light:#f7fafc;--theme-ui-colors-dark:#2d3748;--theme-ui-colors-textMuted:#718096;--theme-ui-colors-toggleIcon:#2d3748;--theme-ui-colors-heading:#000;--theme-ui-colors-divide:#cbd5e0;--theme-ui-colors-highlightLineBg:rgba(0, 0, 0, 0.035);--theme-ui-colors-plain-color:#393A34;--theme-ui-colors-plain-backgroundColor:#f6f8fa;--theme-ui-colors-comment-color:#999988;--theme-ui-colors-comment-fontStyle:italic;--theme-ui-colors-prolog-color:#999988;--theme-ui-colors-prolog-fontStyle:italic;--theme-ui-colors-doctype-color:#999988;--theme-ui-colors-doctype-fontStyle:italic;--theme-ui-colors-cdata-color:#999988;--theme-ui-colors-cdata-fontStyle:italic;--theme-ui-colors-namespace-opacity:0.7;--theme-ui-colors-string-color:#e3116c;--theme-ui-colors-attr-value-color:#e3116c;--theme-ui-colors-punctuation-color:#393A34;--theme-ui-colors-operator-color:#393A34;--theme-ui-colors-entity-color:#36acaa;--theme-ui-colors-url-color:#36acaa;--theme-ui-colors-symbol-color:#36acaa;--theme-ui-colors-number-color:#36acaa;--theme-ui-colors-boolean-color:#36acaa;--theme-ui-colors-variable-color:#36acaa;--theme-ui-colors-constant-color:#36acaa;--theme-ui-colors-property-color:#36acaa;--theme-ui-colors-regex-color:#36acaa;--theme-ui-colors-inserted-color:#36acaa;--theme-ui-colors-atrule-color:#00a4db;--theme-ui-colors-keyword-color:#00009f;--theme-ui-colors-attr-name-color:#00a4db;--theme-ui-colors-selector-color:#00009f;--theme-ui-colors-function-color:#d73a49;--theme-ui-colors-deleted-color:#d73a49;--theme-ui-colors-tag-color:#00009f;--theme-ui-colors-function-variable-color:#6f42c1;}html.theme-ui-dark,.theme-ui-dark html{--theme-ui-colors-text:#cbd5e0;--theme-ui-colors-primary:#b794f4;--theme-ui-colors-secondary:#8a9ab0;--theme-ui-colors-toggleIcon:#cbd5e0;--theme-ui-colors-background:#1A202C;--theme-ui-colors-heading:#fff;--theme-ui-colors-divide:#2d3748;--theme-ui-colors-muted:#2d3748;--theme-ui-colors-highlightLineBg:rgba(255, 255, 255, 0.1);--theme-ui-colors-plain-color:#9CDCFE;--theme-ui-colors-plain-backgroundColor:#1E1E1E;--theme-ui-colors-prolog-color:rgb(0, 0, 128);--theme-ui-colors-comment-color:rgb(106, 153, 85);--theme-ui-colors-builtin-color:rgb(86, 156, 214);--theme-ui-colors-changed-color:rgb(86, 156, 214);--theme-ui-colors-keyword-color:rgb(86, 156, 214);--theme-ui-colors-interpolation-punctuation-color:rgb(86, 156, 214);--theme-ui-colors-number-color:rgb(181, 206, 168);--theme-ui-colors-inserted-color:rgb(181, 206, 168);--theme-ui-colors-constant-color:rgb(100, 102, 149);--theme-ui-colors-attr-name-color:rgb(156, 220, 254);--theme-ui-colors-variable-color:rgb(156, 220, 254);--theme-ui-colors-deleted-color:rgb(206, 145, 120);--theme-ui-colors-string-color:rgb(206, 145, 120);--theme-ui-colors-attr-value-color:rgb(206, 145, 120);--theme-ui-colors-template-punctuation-color:rgb(206, 145, 120);--theme-ui-colors-selector-color:rgb(215, 186, 125);--theme-ui-colors-tag-color:rgb(86, 156, 214);--theme-ui-colors-punctuation-color:#808080;--theme-ui-colors-operator-color:rgb(212, 212, 212);--theme-ui-colors-function-color:rgb(220, 220, 170);--theme-ui-colors-class-name-color:rgb(78, 201, 176);--theme-ui-colors-char-color:rgb(209, 105, 105);}</style><style data-emotion="css-global 1mawjxo">*{box-sizing:border-box;}html{font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";line-height:1.625;font-weight:400;color:var(--theme-ui-colors-text);background-color:var(--theme-ui-colors-background);margin:0;padding:0;box-sizing:border-box;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;-webkit-text-size-adjust:100%;}html img{border-style:none;}html pre{font-family:Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;}html a{-webkit-transition:all 0.3s ease-in-out;transition:all 0.3s ease-in-out;color:var(--theme-ui-colors-text);}body{margin:0;}</style><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><style data-emotion="css-global cjr7z1">*{box-sizing:inherit;}[hidden]{display:none;}::selection{background-color:var(--theme-ui-colors-text);color:var(--theme-ui-colors-background);}</style><style data-emotion="css 1gq7j3t">.css-1gq7j3t{border:0;clip:react(0 0 0 0);height:1px;width:1px;margin:-1px;padding:0;overflow:hidden;position:absolute;}.css-1gq7j3t:focus{padding:1rem;position:fixed;top:15px;left:15px;background-color:var(--theme-ui-colors-heading);color:var(--theme-ui-colors-background);z-index:1;width:auto;height:auto;clip:auto;-webkit-text-decoration:none;text-decoration:none;}</style><a href="#skip-nav" data-skip-link="true" class="css-1gq7j3t">Skip to content</a><style data-emotion="css 10f80pj">.css-10f80pj{box-sizing:border-box;margin:0;min-width:0;width:100%;max-width:container;margin-left:auto;margin-right:auto;padding:1rem;max-width:1024px;}@media screen and (min-width: 640px){.css-10f80pj{padding:2rem;}}</style><div class="css-10f80pj"><style data-emotion="css egutgn">.css-egutgn{margin-bottom:4rem;}@media screen and (min-width: 640px){.css-egutgn{margin-bottom:8rem;}}</style><header class="css-egutgn"><style data-emotion="css 1xwyizx">.css-1xwyizx{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;}</style><style data-emotion="css 1pbimyf">.css-1pbimyf{box-sizing:border-box;margin:0;min-width:0;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;}</style><div class="css-1pbimyf"><style data-emotion="css uxjqfw">.css-uxjqfw{color:var(--theme-ui-colors-heading);-webkit-text-decoration:none;text-decoration:none;}</style><a aria-label="Robaita - Back to home" class="css-uxjqfw" href="/"><style data-emotion="css 19i8ga6">.css-19i8ga6{margin-top:0;margin-bottom:0;font-weight:600;font-size:1.5rem;}@media screen and (min-width: 640px){.css-19i8ga6{font-size:1.875rem;}}</style><div class="css-19i8ga6">Robaita</div></a><style data-emotion="css 3ba0x7">.css-3ba0x7{opacity:0.65;position:relative;border-radius:4px;width:40px;height:25px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;-webkit-transition:opacity 0.3s ease;transition:opacity 0.3s ease;border:none;outline:none;background:none;cursor:pointer;padding:0;-webkit-appearance:none;-moz-appearance:none;-ms-appearance:none;appearance:none;}.css-3ba0x7:hover,.css-3ba0x7:focus{opacity:1;}</style><button type="button" aria-label="Color mode toggle" class="css-3ba0x7"><style data-emotion="css 1ggalm8">.css-1ggalm8{position:relative;width:24px;height:24px;border-radius:50%;-webkit-transition:all 0.45s ease;transition:all 0.45s ease;-webkit-transform:scale(0.55);-moz-transform:scale(0.55);-ms-transform:scale(0.55);transform:scale(0.55);}.css-1ggalm8:before{content:"";position:absolute;right:-9px;top:-9px;height:24px;width:24px;-webkit-transition:-webkit-transform 0.45s ease;transition:transform 0.45s ease;border-radius:50%;opacity:0;}.css-1ggalm8:after{content:"";width:8px;height:8px;border-radius:50%;margin:-4px 0 0 -4px;position:absolute;top:50%;left:50%;-webkit-transition:all 0.35s ease;transition:all 0.35s ease;box-shadow:0 -23px 0 var(--theme-ui-colors-toggleIcon),0 23px 0 var(--theme-ui-colors-toggleIcon),23px 0 0 var(--theme-ui-colors-toggleIcon),-23px 0 0 var(--theme-ui-colors-toggleIcon),15px 15px 0 var(--theme-ui-colors-toggleIcon),-15px 15px 0 var(--theme-ui-colors-toggleIcon),15px -15px 0 var(--theme-ui-colors-toggleIcon),-15px -15px 0 var(--theme-ui-colors-toggleIcon);-webkit-transform:scale(0);-moz-transform:scale(0);-ms-transform:scale(0);transform:scale(0);}</style><div class="css-1ggalm8"></div></button></div><style data-emotion="css fp1v3n">.css-fp1v3n{box-sizing:border-box;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;border-bottom-style:solid;border-bottom-width:1px;border-bottom-color:var(--theme-ui-colors-divide);padding-bottom:1rem;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;margin-top:1rem;color:var(--theme-ui-colors-secondary);-webkit-box-flex-flow:wrap;-webkit-flex-flow:wrap;-ms-flex-flow:wrap;flex-flow:wrap;}.css-fp1v3n a{color:var(--theme-ui-colors-secondary);}.css-fp1v3n a:hover{color:var(--theme-ui-colors-heading);}</style><div class="css-fp1v3n"><style data-emotion="css 1lx5s1f">.css-1lx5s1f{font-size:1rem;}.css-1lx5s1f a:not(:last-of-type){margin-right:1rem;}@media screen and (min-width: 640px){.css-1lx5s1f{font-size:18px;}}.css-1lx5s1f .active{color:var(--theme-ui-colors-heading);}</style><nav class="css-1lx5s1f"><style data-emotion="css bpdkdn">.css-bpdkdn{color:var(--theme-ui-colors-primary);-webkit-text-decoration:none;text-decoration:none;}.css-bpdkdn:hover{-webkit-text-decoration:underline;text-decoration:underline;}</style><a class="css-bpdkdn" href="/blog/">Blog</a><a class="css-bpdkdn" href="/about/">About</a><a class="css-bpdkdn" href="/courses/">Courses</a></nav><style data-emotion="css 45ghvz">.css-45ghvz{font-size:1rem;}.css-45ghvz a:not(:first-of-type){margin-left:1rem;}@media screen and (min-width: 640px){.css-45ghvz{font-size:18px;}}</style><div class="css-45ghvz"><style data-emotion="css aizfxq">.css-aizfxq{box-sizing:border-box;margin:0;min-width:0;color:var(--theme-ui-colors-primary);-webkit-text-decoration:none;text-decoration:none;}.css-aizfxq:hover{-webkit-text-decoration:underline;text-decoration:underline;}</style><a href="https://github.com/robaita" class="css-aizfxq">Github</a><a href="https://robaita.com" class="css-aizfxq">Homepage</a><a href="https://www.linkedin.com/in/dr-avinash-kumar-singh-2a570a31/" class="css-aizfxq">LinkedIn</a></div></div></header><style data-emotion="css 1w9aswf">.css-1w9aswf .prism-code{font-size:1rem;webkit-overflow-scrolling:touch;background-color:var(--theme-ui-colors-transparent);min-width:100%;margin-bottom:0;margin-top:0;overflow:auto;}@media screen and (min-width: 640px){.css-1w9aswf .prism-code{font-size:1rem;}}@media screen and (min-width: 768px){.css-1w9aswf .prism-code{font-size:1.25rem;}}.css-1w9aswf .prism-code[data-linenumber="false"] .token-line{padding-left:1rem;}.css-1w9aswf .gatsby-highlight[data-language='none'] .code-content,.css-1w9aswf .gatsby-highlight[data-language=''] .code-content{padding-top:1rem;}.css-1w9aswf .code-content{padding:2rem 1rem 1rem 1rem;color:var(--theme-ui-colors-plain-color);background-color:var(--theme-ui-colors-plain-backgroundColor);}.css-1w9aswf .token{display:inline-block;}.css-1w9aswf p>code,.css-1w9aswf li>code{background-color:var(--theme-ui-colors-muted);color:var(--theme-ui-colors-heading);padding-left:0.5rem;padding-right:0.5rem;padding-top:0.25rem;padding-bottom:0.25rem;border-radius:4px;font-size:0.95em;}.css-1w9aswf .gatsby-highlight{font-size:1rem;position:relative;webkit-overflow-scrolling:touch;border-radius:4px;overflow:hidden;margin-left:0;margin-right:0;}@media screen and (min-width: 640px){.css-1w9aswf .gatsby-highlight{font-size:1rem;margin-left:0;margin-right:0;}}@media screen and (min-width: 768px){.css-1w9aswf .gatsby-highlight{font-size:1.25rem;margin-left:0;margin-right:0;}}@media screen and (min-width: 1024px){.css-1w9aswf .gatsby-highlight{margin-left:-1rem;margin-right:-1rem;}}.css-1w9aswf .gatsby-highlight .token-line{margin-left:-1rem;margin-right:-1rem;min-width:100%;}.css-1w9aswf .gatsby-highlight pre code{float:left;min-width:100%;}.css-1w9aswf .gatsby-highlight pre[class*="language-"]:before{background-color:var(--theme-ui-colors-white);border-radius:0 0 4px 4px;color:var(--theme-ui-colors-black);font-size:12px;letter-spacing:0.035rem;padding:0.1rem 0.5rem;position:absolute;left:1rem;text-align:right;text-transform:uppercase;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-weight:600;}.css-1w9aswf .gatsby-highlight pre[class~="language-golang"]:before,.css-1w9aswf .gatsby-highlight pre[class~="language-go"]:before{content:"go";background:#79d4fd;color:var(--theme-ui-colors-black);}.css-1w9aswf .gatsby-highlight pre[class~="language-javascript"]:before,.css-1w9aswf .gatsby-highlight pre[class~="language-js"]:before{content:"js";background:#f7df1e;color:var(--theme-ui-colors-black);}.css-1w9aswf .gatsby-highlight pre[class~="language-jsx"]:before{content:"jsx";background:#61dafb;color:var(--theme-ui-colors-black);}.css-1w9aswf .gatsby-highlight pre[class~="language-ts"]:before{content:"ts";background:#61dafb;color:var(--theme-ui-colors-black);}.css-1w9aswf .gatsby-highlight pre[class~="language-tsx"]:before{content:"tsx";background:#61dafb;color:var(--theme-ui-colors-black);}.css-1w9aswf .gatsby-highlight pre[class~="language-html"]:before{content:"html";background:#005a9c;color:var(--theme-ui-colors-white);}.css-1w9aswf .gatsby-highlight pre[class~="language-xml"]:before{content:"xml";background:#005a9c;color:var(--theme-ui-colors-white);}.css-1w9aswf .gatsby-highlight pre[class~="language-svg"]:before{content:"svg";background:#005a9c;color:var(--theme-ui-colors-white);}.css-1w9aswf .gatsby-highlight pre[class~="language-graphql"]:before{content:"GraphQL";background:#E10098;}.css-1w9aswf .gatsby-highlight pre[class~="language-css"]:before{content:"css";background:#ff9800;color:var(--theme-ui-colors-black);}.css-1w9aswf .gatsby-highlight pre[class~="language-mdx"]:before{content:"mdx";background:#f9ac00;color:var(--theme-ui-colors-black);}.css-1w9aswf .gatsby-highlight pre[class~="language-php"]:before{content:"php";background:#777bb3;color:var(--theme-ui-colors-black);}.css-1w9aswf .gatsby-highlight pre[class~="language-py"]:before,.css-1w9aswf .gatsby-highlight pre[class~="language-python"]:before{content:"py";background:#306998;color:var(--theme-ui-colors-white);}.css-1w9aswf .gatsby-highlight pre[class~="language-text"]:before{content:"text";}.css-1w9aswf .gatsby-highlight pre[class~='language-shell']:before{content:'shell';}.css-1w9aswf .gatsby-highlight pre[class~='language-sh']:before{content:'sh';}.css-1w9aswf .gatsby-highlight pre[class~='language-bash']:before{content:'bash';}.css-1w9aswf .gatsby-highlight pre[class~='language-yaml']:before{content:'yaml';background:#ffa8df;}.css-1w9aswf .gatsby-highlight pre[class~='language-yml']:before{content:'yml';background:#ffa8df;}.css-1w9aswf .gatsby-highlight pre[class~='language-markdown']:before{content:'md';}.css-1w9aswf .gatsby-highlight pre[class~='language-json']:before,.css-1w9aswf .gatsby-highlight pre[class~='language-json5']:before{content:'json';background:linen;}.css-1w9aswf .gatsby-highlight pre[class~='language-diff']:before{content:'diff';background:#e6ffed;}.css-1w9aswf .gatsby-highlight>code[class*="language-"],.css-1w9aswf .gatsby-highlight>pre[class=*="language-"]{word-spacing:normal;word-break:normal;overflow-wrap:normal;line-height:1.5;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;}.css-1w9aswf .gatsby-highlight pre::-webkit-scrollbar{width:0.5rem;height:0.5rem;}.css-1w9aswf .gatsby-highlight pre::-webkit-scrollbar-thumb{background-color:var(--theme-ui-colors-primary);}.css-1w9aswf .gatsby-highlight pre::-webkit-scrollbar-track{background:var(--theme-ui-colors-muted);}.css-1w9aswf .line-number-style{display:inline-block;width:3em;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;opacity:0.3;text-align:center;position:relative;}.css-1w9aswf .code-title{background-color:var(--theme-ui-colors-muted);color:var(--theme-ui-colors-text);font-size:1rem;padding-left:1rem;padding-right:1rem;padding-top:0.5rem;padding-bottom:0.5rem;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";}.css-1w9aswf .token-line{padding-right:1rem;}.css-1w9aswf .highlight-line{border-left:4px solid rgb(2, 155, 206);}.css-1w9aswf .highlight-line .line-number-style{width:calc(3em - 4px);opacity:0.5;left:-2px;}.css-1w9aswf .footnotes{border-top-style:solid;border-top-width:1px;border-top-color:var(--theme-ui-colors-divide);padding-top:0.5rem;margin-top:4rem;overflow:auto;}.css-1w9aswf .footnotes .sr-only{border:0;clip:rect(0, 0, 0, 0);height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute;white-space:nowrap;width:1px;}</style><style data-emotion="css 1wlcpc3">.css-1wlcpc3{box-sizing:border-box;margin:0;min-width:0;}.css-1wlcpc3 .prism-code{font-size:1rem;webkit-overflow-scrolling:touch;background-color:var(--theme-ui-colors-transparent);min-width:100%;margin-bottom:0;margin-top:0;overflow:auto;}@media screen and (min-width: 640px){.css-1wlcpc3 .prism-code{font-size:1rem;}}@media screen and (min-width: 768px){.css-1wlcpc3 .prism-code{font-size:1.25rem;}}.css-1wlcpc3 .prism-code[data-linenumber="false"] .token-line{padding-left:1rem;}.css-1wlcpc3 .gatsby-highlight[data-language='none'] .code-content,.css-1wlcpc3 .gatsby-highlight[data-language=''] .code-content{padding-top:1rem;}.css-1wlcpc3 .code-content{padding:2rem 1rem 1rem 1rem;color:var(--theme-ui-colors-plain-color);background-color:var(--theme-ui-colors-plain-backgroundColor);}.css-1wlcpc3 .token{display:inline-block;}.css-1wlcpc3 p>code,.css-1wlcpc3 li>code{background-color:var(--theme-ui-colors-muted);color:var(--theme-ui-colors-heading);padding-left:0.5rem;padding-right:0.5rem;padding-top:0.25rem;padding-bottom:0.25rem;border-radius:4px;font-size:0.95em;}.css-1wlcpc3 .gatsby-highlight{font-size:1rem;position:relative;webkit-overflow-scrolling:touch;border-radius:4px;overflow:hidden;margin-left:0;margin-right:0;}@media screen and (min-width: 640px){.css-1wlcpc3 .gatsby-highlight{font-size:1rem;margin-left:0;margin-right:0;}}@media screen and (min-width: 768px){.css-1wlcpc3 .gatsby-highlight{font-size:1.25rem;margin-left:0;margin-right:0;}}@media screen and (min-width: 1024px){.css-1wlcpc3 .gatsby-highlight{margin-left:-1rem;margin-right:-1rem;}}.css-1wlcpc3 .gatsby-highlight .token-line{margin-left:-1rem;margin-right:-1rem;min-width:100%;}.css-1wlcpc3 .gatsby-highlight pre code{float:left;min-width:100%;}.css-1wlcpc3 .gatsby-highlight pre[class*="language-"]:before{background-color:var(--theme-ui-colors-white);border-radius:0 0 4px 4px;color:var(--theme-ui-colors-black);font-size:12px;letter-spacing:0.035rem;padding:0.1rem 0.5rem;position:absolute;left:1rem;text-align:right;text-transform:uppercase;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-weight:600;}.css-1wlcpc3 .gatsby-highlight pre[class~="language-golang"]:before,.css-1wlcpc3 .gatsby-highlight pre[class~="language-go"]:before{content:"go";background:#79d4fd;color:var(--theme-ui-colors-black);}.css-1wlcpc3 .gatsby-highlight pre[class~="language-javascript"]:before,.css-1wlcpc3 .gatsby-highlight pre[class~="language-js"]:before{content:"js";background:#f7df1e;color:var(--theme-ui-colors-black);}.css-1wlcpc3 .gatsby-highlight pre[class~="language-jsx"]:before{content:"jsx";background:#61dafb;color:var(--theme-ui-colors-black);}.css-1wlcpc3 .gatsby-highlight pre[class~="language-ts"]:before{content:"ts";background:#61dafb;color:var(--theme-ui-colors-black);}.css-1wlcpc3 .gatsby-highlight pre[class~="language-tsx"]:before{content:"tsx";background:#61dafb;color:var(--theme-ui-colors-black);}.css-1wlcpc3 .gatsby-highlight pre[class~="language-html"]:before{content:"html";background:#005a9c;color:var(--theme-ui-colors-white);}.css-1wlcpc3 .gatsby-highlight pre[class~="language-xml"]:before{content:"xml";background:#005a9c;color:var(--theme-ui-colors-white);}.css-1wlcpc3 .gatsby-highlight pre[class~="language-svg"]:before{content:"svg";background:#005a9c;color:var(--theme-ui-colors-white);}.css-1wlcpc3 .gatsby-highlight pre[class~="language-graphql"]:before{content:"GraphQL";background:#E10098;}.css-1wlcpc3 .gatsby-highlight pre[class~="language-css"]:before{content:"css";background:#ff9800;color:var(--theme-ui-colors-black);}.css-1wlcpc3 .gatsby-highlight pre[class~="language-mdx"]:before{content:"mdx";background:#f9ac00;color:var(--theme-ui-colors-black);}.css-1wlcpc3 .gatsby-highlight pre[class~="language-php"]:before{content:"php";background:#777bb3;color:var(--theme-ui-colors-black);}.css-1wlcpc3 .gatsby-highlight pre[class~="language-py"]:before,.css-1wlcpc3 .gatsby-highlight pre[class~="language-python"]:before{content:"py";background:#306998;color:var(--theme-ui-colors-white);}.css-1wlcpc3 .gatsby-highlight pre[class~="language-text"]:before{content:"text";}.css-1wlcpc3 .gatsby-highlight pre[class~='language-shell']:before{content:'shell';}.css-1wlcpc3 .gatsby-highlight pre[class~='language-sh']:before{content:'sh';}.css-1wlcpc3 .gatsby-highlight pre[class~='language-bash']:before{content:'bash';}.css-1wlcpc3 .gatsby-highlight pre[class~='language-yaml']:before{content:'yaml';background:#ffa8df;}.css-1wlcpc3 .gatsby-highlight pre[class~='language-yml']:before{content:'yml';background:#ffa8df;}.css-1wlcpc3 .gatsby-highlight pre[class~='language-markdown']:before{content:'md';}.css-1wlcpc3 .gatsby-highlight pre[class~='language-json']:before,.css-1wlcpc3 .gatsby-highlight pre[class~='language-json5']:before{content:'json';background:linen;}.css-1wlcpc3 .gatsby-highlight pre[class~='language-diff']:before{content:'diff';background:#e6ffed;}.css-1wlcpc3 .gatsby-highlight>code[class*="language-"],.css-1wlcpc3 .gatsby-highlight>pre[class=*="language-"]{word-spacing:normal;word-break:normal;overflow-wrap:normal;line-height:1.5;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;}.css-1wlcpc3 .gatsby-highlight pre::-webkit-scrollbar{width:0.5rem;height:0.5rem;}.css-1wlcpc3 .gatsby-highlight pre::-webkit-scrollbar-thumb{background-color:var(--theme-ui-colors-primary);}.css-1wlcpc3 .gatsby-highlight pre::-webkit-scrollbar-track{background:var(--theme-ui-colors-muted);}.css-1wlcpc3 .line-number-style{display:inline-block;width:3em;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;opacity:0.3;text-align:center;position:relative;}.css-1wlcpc3 .code-title{background-color:var(--theme-ui-colors-muted);color:var(--theme-ui-colors-text);font-size:1rem;padding-left:1rem;padding-right:1rem;padding-top:0.5rem;padding-bottom:0.5rem;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";}.css-1wlcpc3 .token-line{padding-right:1rem;}.css-1wlcpc3 .highlight-line{border-left:4px solid rgb(2, 155, 206);}.css-1wlcpc3 .highlight-line .line-number-style{width:calc(3em - 4px);opacity:0.5;left:-2px;}.css-1wlcpc3 .footnotes{border-top-style:solid;border-top-width:1px;border-top-color:var(--theme-ui-colors-divide);padding-top:0.5rem;margin-top:4rem;overflow:auto;}.css-1wlcpc3 .footnotes .sr-only{border:0;clip:rect(0, 0, 0, 0);height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute;white-space:nowrap;width:1px;}</style><main id="skip-nav" class=" css-1wlcpc3"><style data-emotion="css w1q1hj">.css-w1q1hj{box-sizing:border-box;margin:0;min-width:0;font-family:inherit;font-weight:700;line-height:1.25;font-family:inherit;font-weight:700;line-height:1.25;margin:0;margin-bottom:0.25rem;font-size:1.875rem;margin-top:2rem;color:var(--theme-ui-colors-heading);}@media screen and (min-width: 640px){.css-w1q1hj{font-size:2.25rem;}}@media screen and (min-width: 768px){.css-w1q1hj{font-size:2.25rem;}}@media screen and (min-width: 1024px){.css-w1q1hj{font-size:3rem;}}</style><h1 class="css-w1q1hj">Attention Please!</h1><style data-emotion="css 15ce8we">.css-15ce8we{color:var(--theme-ui-colors-secondary);margin-top:1rem;font-size:1rem;}.css-15ce8we a{color:var(--theme-ui-colors-secondary);}@media screen and (min-width: 640px){.css-15ce8we{font-size:1rem;}}@media screen and (min-width: 768px){.css-15ce8we{font-size:1.25rem;}}</style><p class="css-15ce8we"><time>22.07.2024</time> — <a class="css-bpdkdn" href="/tags/cnn/">CNN</a>, <a class="css-bpdkdn" href="/tags/attention/">Attention</a>, <a class="css-bpdkdn" href="/tags/tensor-flow/">TensorFlow</a> — <span>6<!-- --> min read</span></p><style data-emotion="css 1mae7sn">.css-1mae7sn{margin-top:4rem;margin-bottom:4rem;}.css-1mae7sn .gatsby-resp-image-wrapper{margin-top:2rem;margin-bottom:2rem;border-radius:4px;box-shadow:rgba(0, 0, 0, 0.1) 0px 16px 16px 0px,rgba(0, 0, 0, 0.1) 0px 8px 8px 0px,rgba(0, 0, 0, 0.1) 0px 4px 4px 0px;}@media screen and (min-width: 640px){.css-1mae7sn .gatsby-resp-image-wrapper{margin-top:2rem;margin-bottom:2rem;}}@media screen and (min-width: 768px){.css-1mae7sn .gatsby-resp-image-wrapper{margin-top:4rem;margin-bottom:4rem;}}.css-1mae7sn .gatsby-resp-image-wrapper .gatsby-resp-image-image{border-radius:4px;}.css-1mae7sn figure{margin:0;}.css-1mae7sn figure img{border-radius:4px;box-shadow:0 10px 15px -3px rgba(0, 0, 0, 0.1),0 4px 6px -2px rgba(0, 0, 0, 0.05);max-width:100%;}</style><section class="css-1mae7sn"><style data-emotion="css 90ntna">.css-90ntna{font-family:inherit;font-weight:700;line-height:1.25;margin:0;margin-bottom:0.25rem;font-size:1.5rem;margin-top:2rem;color:var(--theme-ui-colors-heading);}@media screen and (min-width: 640px){.css-90ntna{font-size:1.875rem;}}@media screen and (min-width: 768px){.css-90ntna{font-size:1.875rem;}}@media screen and (min-width: 1024px){.css-90ntna{font-size:2.25rem;}}</style><style data-emotion="css 1h962gv">.css-1h962gv{font-family:inherit;font-weight:700;line-height:1.25;margin:0;margin-bottom:0.25rem;font-size:1.5rem;margin-top:2rem;color:var(--theme-ui-colors-heading);font-family:inherit;font-weight:700;line-height:1.25;margin:0;margin-bottom:0.25rem;font-size:1.5rem;margin-top:2rem;color:var(--theme-ui-colors-heading);}@media screen and (min-width: 640px){.css-1h962gv{font-size:1.875rem;}}@media screen and (min-width: 768px){.css-1h962gv{font-size:1.875rem;}}@media screen and (min-width: 1024px){.css-1h962gv{font-size:2.25rem;}}@media screen and (min-width: 640px){.css-1h962gv{font-size:1.875rem;}}@media screen and (min-width: 768px){.css-1h962gv{font-size:1.875rem;}}@media screen and (min-width: 1024px){.css-1h962gv{font-size:2.25rem;}}</style><h2 class="css-1h962gv">Overview</h2>
<style data-emotion="css vehe2z">.css-vehe2z{font-size:1rem;letter-spacing:-0.003em;line-height:1.625;--baseline-multiplier:0.179;--x-height-multiplier:0.35;word-break:break-word;}@media screen and (min-width: 640px){.css-vehe2z{font-size:1rem;}}@media screen and (min-width: 768px){.css-vehe2z{font-size:1.25rem;}}</style><style data-emotion="css z0logh">.css-z0logh{font-size:1rem;letter-spacing:-0.003em;line-height:1.625;--baseline-multiplier:0.179;--x-height-multiplier:0.35;word-break:break-word;font-size:1rem;letter-spacing:-0.003em;line-height:1.625;--baseline-multiplier:0.179;--x-height-multiplier:0.35;word-break:break-word;}@media screen and (min-width: 640px){.css-z0logh{font-size:1rem;}}@media screen and (min-width: 768px){.css-z0logh{font-size:1.25rem;}}@media screen and (min-width: 640px){.css-z0logh{font-size:1rem;}}@media screen and (min-width: 768px){.css-z0logh{font-size:1.25rem;}}</style><p class="css-z0logh">This article would discuss the following concepts</p>
<style data-emotion="css 1loxung">.css-1loxung{border-left-color:var(--theme-ui-colors-primary);border-left-style:solid;border-left-width:4px;margin-left:0;margin-right:0;padding-left:2rem;}.css-1loxung p{font-style:italic;}</style><style data-emotion="css m9jm23">.css-m9jm23{border-left-color:var(--theme-ui-colors-primary);border-left-style:solid;border-left-width:4px;margin-left:0;margin-right:0;padding-left:2rem;border-left-color:var(--theme-ui-colors-primary);border-left-style:solid;border-left-width:4px;margin-left:0;margin-right:0;padding-left:2rem;}.css-m9jm23 p{font-style:italic;}.css-m9jm23 p{font-style:italic;}</style><blockquote class="css-m9jm23">
<style data-emotion="css rc057y">.css-rc057y li{font-size:1rem;letter-spacing:-0.003em;line-height:1.625;--baseline-multiplier:0.179;--x-height-multiplier:0.35;}@media screen and (min-width: 640px){.css-rc057y li{font-size:1rem;}}@media screen and (min-width: 768px){.css-rc057y li{font-size:1.25rem;}}</style><style data-emotion="css 15vy6y4">.css-15vy6y4 li{font-size:1rem;letter-spacing:-0.003em;line-height:1.625;--baseline-multiplier:0.179;--x-height-multiplier:0.35;}@media screen and (min-width: 640px){.css-15vy6y4 li{font-size:1rem;}}@media screen and (min-width: 768px){.css-15vy6y4 li{font-size:1.25rem;}}.css-15vy6y4 li{font-size:1rem;letter-spacing:-0.003em;line-height:1.625;--baseline-multiplier:0.179;--x-height-multiplier:0.35;}@media screen and (min-width: 640px){.css-15vy6y4 li{font-size:1rem;}}@media screen and (min-width: 768px){.css-15vy6y4 li{font-size:1.25rem;}}</style><ol class="css-15vy6y4">
<li class="css-zezy6m">Basic intuation of attention model</li>
<li class="css-zezy6m">Mathematics behind the attention model</li>
<li class="css-zezy6m">Implementation of attention mechanism</li>
<li class="css-zezy6m">Use of Tensorflow <code class="css-zezy6m">tf.keras.layers.MultiHeadAttention</code> API</li>
<li class="css-zezy6m">Multi-Head Attention
Without further delay, lets deep dive into what is attention mechanism, why it is so popular?</li>
</ol>
</blockquote>
<h2 class="css-1h962gv">Basic intuation of attention model</h2>
<p class="css-z0logh">Imagine you are reading a book, and you come across a character whose actions are essential to understand the current plot. To make sense of what&#x27;s happening, you need to remember previous details about this character. Here’s how the attention mechanism works in this context: <br/>
<strong>Query:</strong> Think of the query as the question you&#x27;re asking while reading. For example, &quot;What has this character done before?&quot; <br/>
<strong>Key:</strong> The key is like an index or a set of clues that help you find the right information in the book. It&#x27;s the reference to different points in the story where this character is mentioned. <br/>
<strong>Value:</strong> The value is the actual information you need about the character, like their past actions and traits.</p>
<p class="css-z0logh">If we explain the same example in terms of python data types then it would be something similar to as described in the below example. The query is the question that we are looking for, key is the reference that can be <code class="css-zezy6m">mahabharata_characters</code> and value would be the value of the query. So if we are looking for the character <code class="css-zezy6m">Ashwatthama</code> then the <code class="css-zezy6m">mahabharata_characters</code> would be the reference, treated as key and the value as <code class="css-zezy6m">The formidable warrior and son of Dronacharya, known for his unrelenting pursuit of revenge against the Pandavas</code>.</p>
<div class="gatsby-highlight" data-language="python:title=Dictionary.py"><pre class="prism-code language-python:title=dictionary.py" data-linenumber="false"><style data-emotion="css ce1lkk">.css-ce1lkk{background-color:var(--theme-ui-colors-background);border:none;color:var(--theme-ui-colors-text);cursor:pointer;font-size:14px;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";letter-spacing:0.025rem;-webkit-transition:all 0.3s ease-in-out;transition:all 0.3s ease-in-out;position:absolute;right:0;z-index:1;border-radius:0 0 0 0.25rem;padding:0.25rem 0.6rem;}@media screen and (min-width: 640px){.css-ce1lkk{font-size:14px;}}@media screen and (min-width: 768px){.css-ce1lkk{font-size:16px;}}.css-ce1lkk[disabled]{cursor:not-allowed;}.css-ce1lkk:not([disabled]):hover{background-color:var(--theme-ui-colors-primary);color:var(--theme-ui-colors-white);}</style><button type="button" name="copy code to clipboard" class="code-copy-button css-ce1lkk">Copy<style data-emotion="css 15vf505">.css-15vf505{border:0;clip:rect(0, 0, 0, 0);height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute;white-space:nowrap;width:1px;}</style><span aria-roledescription="status" class="css-15vf505">copy code to clipboard</span></button><code class="code-content language-python:title=Dictionary.py"><div class="token-line" style="color:var(--theme-ui-colors-plain-color)"><span class="token plain"># dictionary of characters and their description</span></div><div class="token-line" style="color:var(--theme-ui-colors-plain-color)"><span class="token plain">mahabharata_characters = {</span></div><div class="token-line" style="color:var(--theme-ui-colors-plain-color)"><span class="token plain">    &quot;Arjuna&quot;: &quot;The peerless archer, whose valor and skill were unmatched on the battlefield of Kurukshetra&quot;,</span></div><div class="token-line" style="color:var(--theme-ui-colors-plain-color)"><span class="token plain">    &quot;Krishna&quot;: &quot;The divine charioteer and guide to Arjuna, whose wisdom and counsel in the Bhagavad Gita are legendary.&quot;,</span></div><div class="token-line" style="color:var(--theme-ui-colors-plain-color)"><span class="token plain">    &quot;Bhishma&quot;: &quot;The grand patriarch of the Kuru dynasty, renowned for his vow of celibacy and unparalleled warrior prowess.&quot;,</span></div><div class="token-line" style="color:var(--theme-ui-colors-plain-color)"><span class="token plain">    &quot;Draupadi&quot;: &quot;The fiery princess and wife of the Pandavas, whose dignity and strength became a rallying point in their quest for justice.&quot;,</span></div><div class="token-line" style="color:var(--theme-ui-colors-plain-color)"><span class="token plain">    &quot;Karna&quot;: &quot;The tragic hero and unparalleled warrior, known for his unwavering loyalty to Duryodhana and his inner conflict regarding his true lineage.&quot;</span></div><div class="token-line" style="color:var(--theme-ui-colors-plain-color)"><span class="token plain">    &quot;Ashwatthama&quot;: &quot;The formidable warrior and son of Dronacharya, known for his unrelenting pursuit of revenge against the Pandavas.&quot;</span></div><div class="token-line" style="color:var(--theme-ui-colors-plain-color)"><span class="token plain">}</span></div></code></pre></div>
<p class="css-z0logh">Build upon this intuation, attention mechanism keeps the track of long sequences and give more weightsage to only certain portion who are useful for the token.</p>
<h2 class="css-1h962gv">Mathematics behind the attention model</h2>
<p class="css-z0logh">If we see the architecture proposed in the paper<sup><style data-emotion="css 1d2wwf6">.css-1d2wwf6{color:var(--theme-ui-colors-primary);-webkit-text-decoration:none;text-decoration:none;}.css-1d2wwf6:hover{-webkit-text-decoration:underline;text-decoration:underline;}</style><style data-emotion="css 1diwg7s">.css-1diwg7s{color:var(--theme-ui-colors-primary);-webkit-text-decoration:none;text-decoration:none;color:var(--theme-ui-colors-primary);-webkit-text-decoration:none;text-decoration:none;}.css-1diwg7s:hover{-webkit-text-decoration:underline;text-decoration:underline;}.css-1diwg7s:hover{-webkit-text-decoration:underline;text-decoration:underline;}</style><a href="#user-content-fn-1" id="user-content-fnref-1" data-footnote-ref="true" aria-describedby="footnote-label" class="css-1diwg7s">1</a></sup>, it has the following component <code class="css-zezy6m">Scale</code>, <code class="css-zezy6m">Mask (Opt)</code>, <code class="css-zezy6m">Softmax</code> and <code class="css-zezy6m">matmul</code>. These are expressed in the hand written notes.
<span><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 562px; "
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 53.75%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAABJ0AAASdAHeZh94AAABwUlEQVR42n1SDW+aUBT1//+FJeuWNV1SV+3HVOpa+ylr/QBsdTqtCwgoRAt0Cigfnr33WlqT6k7yuOTdew+ce09qNBpBVVXoug5ZljEYqBgOhyQO4LouKJbLJVZhmiYGigJN02AYBuuzLIvlUkEQYD6fY7EIEIYhgmCBOI7ZXRRFWAeaN0wD0l0DjuOQ3gXrZYTJ16dTD8Ucj/zhFUShjU2I4+d6VddQujjH48ufJTwp+gijEJW7OvZy31H+WUW/J6+VugpdldAQ9zAe998T2o6N4xKHC76Ebq+D2Wz2jjB5tywbrdZvoqKGQn6fRBGd9gMUWWOjYIRjncyDu0aDK6MnNDFdQ/giGPxlE7vbV/j8oYBP5Gx/LCLzlceXrQM8/XUSyTHERoHI3cF4MiLb9TZK7nYUcLkyxFoX2W8c6pU2igUeQv2e1TNC1/VxnC8hf/QDD2R+rrtZcvPXPdLZNE7PTpE5zOLk7AS7mTRuq5W3GXqejxteQvW2hT/9zf6j0IhfRUki3lMgkEh9WxPqxEbmGyFtpP6LyLbDMHj11DrQnG3brCeJk8nkNZ9alZSc/4FukhqZ1vm+j2eFHrunhP8ATUc8bC2jp9MAAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="attention 1"
        title=""
        src="/static/97fcca73755a96557680f3a08c26b760/eef63/attention-1.png"
        srcset="/static/97fcca73755a96557680f3a08c26b760/5243c/attention-1.png 240w,
/static/97fcca73755a96557680f3a08c26b760/ab158/attention-1.png 480w,
/static/97fcca73755a96557680f3a08c26b760/eef63/attention-1.png 562w"
        sizes="(max-width: 562px) 100vw, 562px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
        decoding="async"
      />
    </span></span>
The scaling or normalization is performed as if the value of dk become a large number, then the dot products grow large in magnitude, pushing the softmax function into regions where it has extremely small gradients. To counteract this effect, we scale the dot products by <code class="css-zezy6m">1/sqrt(dk)</code> <sup><a href="#user-content-fn-1" id="user-content-fnref-1-2" data-footnote-ref="true" aria-describedby="footnote-label" class="css-1diwg7s">1</a></sup>. The mask operation is optional, this one is used, in sequence to sequence generation or similar application. When the objective of the model is to predict the next token (word), and the input feature is the collection of previous words and the next word. If we want to mask the future token, in that situation we can use this masking operation. This sets the upper tringular matrix of the dot product between query and key to infinte and when we apply softmax on top of this, the upper tringular matrix is set to zero. This we do to make the sum equal to 1. For more reference, follow this video <sup><a href="#user-content-fn-2" id="user-content-fnref-2" data-footnote-ref="true" aria-describedby="footnote-label" class="css-1diwg7s">2</a></sup>.
<span><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; "
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 139.58333333333334%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAcCAYAAABh2p9gAAAACXBIWXMAAAsTAAALEwEAmpwYAAAD7klEQVR42m2W2ZbqOAxFnYQkkAEyQOYw3l5Vj/X/P6fWFmWK6tsPwoplH03HNq4oCpmmSeZ5lqqq5HK5mDDvnJMgCCQMQxu9+G/GKIpMZ0RclmUyDIMcj0cDRMcBep7nst1uZbfbmQO/hj3YPBi2OI4tAIfCorIsZVkW0/u+t+91XU1HxnGUw+FgQNjqujbgJEnMlqbpExAvpMvij48P07uuk/1+b2PbtjbnneCULPhm/nQ62RzpGyA/gGEk1cfjYUBsZu52u1mqzBEVa9CZp9Z+LakbIAqLCJsNb55ehfff7/ObzeZXo152PqgFUfoGUCdG6ovu7RSfaNApCWk3TfNqmNWRCABiI0J9EGrDQjaQFhl4nVJQW8rz9fVlDiiB0YYI8URhMQCEdwDYDKi3AQgYdubP61kaLRN7rperRGH0bAr18NSABkRMmqRNitWhknlVSp0aOTSV1E0t4zzKsTvKfFmk1XGbbX+67GuBZ9LGO15xgO3z81Nu603OxSxzNsi1WeVan6WNKznH2vWgkZOrpXLls4a0v6orqwvAFLc9tq9CY0vjVDK3lX2QSxWUpudBJkWwkybUwxBplC59RkhEtaZV5IVFSXTZLrNUiZjxUB1kuS5SVqV0U29pV5p+Pw0m1z83yYpcAQMn+3Iv53ySoehk0pTKai9rNkmfaYNUJ2pLv+sNvG1aOR1P8rg/ZBxGa0hZlD81LDWqcl9aA/Ist1RLoi2fYAi28/n8apbnnm/g6yx7hpMmm3wz0ButKYupracKHMUBIycLUN+8FyCEhHNwjYXX69Wi8JxkZAPACJFyE8FP9kFwvr+PoLPz2vVK4r1GMA5yf9wlTmJtRGWARMlIZNX3ERzUgQEtq8zTbCR/ASJpmEgeaS2iVJIoMdZnqQJlWletZ6up0Vm6baxQnUb0Y291fLs8nkrpcmnc3saDEjR3OyNq6yrpXGPj7DobB3dUaXVeuarfd7cqN/e/Ae0IusiAdkra1CUSu41KLFEQSRLEEgcbiXRNoYTOgq2EQWhzrI9c+Ddg4TKLgojOTjunESDMPzSKq5stwptbZHF6g+t86IL/3pc/l+avi5I5XYyE6p0oEvd8iC7bWe7pWbZJavb/BURIcXGDRbgGOoaNbDRdzu0/7iKjO1l912yWIevkmOqTUA2SpMlvQK4vpMj0dCT6JIZKmeIgdVU/GaCRpIFea3pB7MKtAU9hJxtlQqqM8O/yizacisKo8XMieGcguX/14CIjtku/yn25mW1VkvP0QnDu0l8pY+AG9lc/p8W/J9X3O7IokcdpVKDVThR3pf+X8TdtNG3/98K/dq9/BG+CnXPsH653+781R4QvI38epwAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="attention 2"
        title=""
        src="/static/fe71b6a03016d0546283780acee4aeb2/7d769/attention-2.png"
        srcset="/static/fe71b6a03016d0546283780acee4aeb2/5243c/attention-2.png 240w,
/static/fe71b6a03016d0546283780acee4aeb2/ab158/attention-2.png 480w,
/static/fe71b6a03016d0546283780acee4aeb2/7d769/attention-2.png 960w,
/static/fe71b6a03016d0546283780acee4aeb2/9485b/attention-2.png 1155w"
        sizes="(max-width: 960px) 100vw, 960px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
        decoding="async"
      />
    </span></span>
<span><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; "
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 69.58333333333333%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsTAAALEwEAmpwYAAACLklEQVR42pVTXW/bMAykZPlDkh27jmM7TpMtSdOhL8MwbMDSAXvI//9PN1Ky26xvezjLEsUjKR6JshJkLCitQDrjlff5A68elPGZ3YCKls+auM/qaOd9YltkZRd9iWYYB114FN2ApGLnxCGc2Rq66ZlwzYRraA6c+DWS4YCk30Fpg8vzC67XK4ZhCGRKKZB8pm6F89Sg6SokuYPRBF+vYPoe2nOmzqKoPIaeiR0HXFXwqxVer79wu91wOBwCoVYa5NnhdH7Cy/nEkRpU7QZbjpj7CvnmETpJkegcaZrCMrE4Wi4542q+//yB1z+/cTk+4Zk+4ah2McNxHDGNA4ZNGx1sgabuYNMWqS5gVAFnHdZty1kYWLPiewkO+wO+ffmKS3nEKd1hnQZ/gjEmgNnndyA0vsGQbqHYnpJBQhoVVyOZLg1wHOis95iox9h0yG0eCd+hZhBK7TCpDSwVqMiHdfPQoXTcQMrDXiDBxO7IhqD0kWhBwiW1VC+X3qD43oJ33/ukuP2U8ZsYH/VVRJmQG1lCXELqovYEfox6nHVIbgjaVEXHMlqeQlotBtdHAQcndi5Za6JB28WAAhH9ck/WvI2iln8JHAlVPGCCIGI/xYmQSZEpEfhtJBYCCV6fQNU+VsHZBR/b3xEumUgpkmHIah6z8pGF/DkSyb+QyCoQ0hC0iwkoNTdFMiin2VCG0Yvz7WN58pbhbecMxS73pKr7eX8jNEU0SFRp0j9d+z/8BXgxNM7pR2LhAAAAAElFTkSuQmCC'); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="attention 3"
        title=""
        src="/static/f4923867f5990a11beb3746736fcf62a/7d769/attention-3.png"
        srcset="/static/f4923867f5990a11beb3746736fcf62a/5243c/attention-3.png 240w,
/static/f4923867f5990a11beb3746736fcf62a/ab158/attention-3.png 480w,
/static/f4923867f5990a11beb3746736fcf62a/7d769/attention-3.png 960w,
/static/f4923867f5990a11beb3746736fcf62a/87339/attention-3.png 1440w,
/static/f4923867f5990a11beb3746736fcf62a/2b633/attention-3.png 1749w"
        sizes="(max-width: 960px) 100vw, 960px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
        decoding="async"
      />
    </span></span></p>
<h2 class="css-1h962gv">Implementation of attention mechanism</h2>
<p class="css-z0logh">This section is the implementation of the above section in Tensorflow, I have taken reference from Professor Mubarak Shah Lecture, you can visit for more details <sup><a href="#user-content-fn-3" id="user-content-fnref-3" data-footnote-ref="true" aria-describedby="footnote-label" class="css-1diwg7s">3</a></sup>.</p>
<div class="gatsby-highlight" data-language="python:title=attention_model.py"><pre class="prism-code language-python:title=attention_model.py" data-linenumber="false"><button type="button" name="copy code to clipboard" class="code-copy-button css-ce1lkk">Copy<span aria-roledescription="status" class="css-15vf505">copy code to clipboard</span></button><code class="code-content language-python:title=attention_model.py"><div class="token-line" style="color:var(--theme-ui-colors-plain-color)"><span class="token plain">input_shape = (224, 224, 3)  # Assuming a 3-channel (RGB) image</span></div><div class="token-line" style="color:var(--theme-ui-colors-plain-color)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:var(--theme-ui-colors-plain-color)"><span class="token plain"># Define the input layer</span></div><div class="token-line" style="color:var(--theme-ui-colors-plain-color)"><span class="token plain">inputs = tf.keras.Input(shape=input_shape)</span></div><div class="token-line" style="color:var(--theme-ui-colors-plain-color)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:var(--theme-ui-colors-plain-color)"><span class="token plain"># Add a pre-trained ResNet50 layer (excluding the top classification layer)</span></div><div class="token-line" style="color:var(--theme-ui-colors-plain-color)"><span class="token plain">resnet50_base = applications.ResNet50(include_top=False, weights=&#x27;imagenet&#x27;, input_tensor=inputs)</span></div><div class="token-line" style="color:var(--theme-ui-colors-plain-color)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:var(--theme-ui-colors-plain-color)"><span class="token plain"># number of filters</span></div><div class="token-line" style="color:var(--theme-ui-colors-plain-color)"><span class="token plain">dq = dk = dv =3</span></div><div class="token-line" style="color:var(--theme-ui-colors-plain-color)"><span class="token plain">feature_dimension = (resnet50_base.output_shape[1], resnet50_base.output_shape[2], dk)</span></div><div class="token-line" style="color:var(--theme-ui-colors-plain-color)"><span class="token plain">print(&quot;Output feature dimension:&quot;,feature_dimension)</span></div><div class="token-line" style="color:var(--theme-ui-colors-plain-color)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:var(--theme-ui-colors-plain-color)"><span class="token plain"># Add a 1x1 convolutional layer to get the query</span></div><div class="token-line" style="color:var(--theme-ui-colors-plain-color)"><span class="token plain">query = layers.Conv2D(filters=dq, kernel_size=(1, 1), activation=&#x27;relu&#x27;, padding=&#x27;same&#x27;, name=&quot;query&quot;)(resnet50_base.output)</span></div><div class="token-line" style="color:var(--theme-ui-colors-plain-color)"><span class="token plain">print(&quot;Query output shape:&quot;, query.shape)</span></div><div class="token-line" style="color:var(--theme-ui-colors-plain-color)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:var(--theme-ui-colors-plain-color)"><span class="token plain"># Add a 1x1 convolutional layer to get the key</span></div><div class="token-line" style="color:var(--theme-ui-colors-plain-color)"><span class="token plain">key = layers.Conv2D(filters=dk, kernel_size=(1, 1), activation=&#x27;relu&#x27;, padding=&#x27;same&#x27;, name=&quot;key&quot;)(resnet50_base.output)</span></div><div class="token-line" style="color:var(--theme-ui-colors-plain-color)"><span class="token plain">print(&quot;Key output shape:&quot;, key.shape)</span></div><div class="token-line" style="color:var(--theme-ui-colors-plain-color)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:var(--theme-ui-colors-plain-color)"><span class="token plain"># Add a 1x1 convolutional layer to get the value</span></div><div class="token-line" style="color:var(--theme-ui-colors-plain-color)"><span class="token plain">value = layers.Conv2D(filters=dv, kernel_size=(1, 1), activation=&#x27;relu&#x27;, padding=&#x27;same&#x27;, name=&quot;value&quot;)(resnet50_base.output)</span></div><div class="token-line" style="color:var(--theme-ui-colors-plain-color)"><span class="token plain">print(&quot;Value output shape:&quot;, value.shape)</span></div><div class="token-line" style="color:var(--theme-ui-colors-plain-color)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:var(--theme-ui-colors-plain-color)"><span class="token plain"># Flatten the conv_layer to a 2D tensor</span></div><div class="token-line" style="color:var(--theme-ui-colors-plain-color)"><span class="token plain">flattened_query = layers.Reshape((-1, 3))(query)</span></div><div class="token-line" style="color:var(--theme-ui-colors-plain-color)"><span class="token plain">flattened_key = layers.Reshape((-1, 3))(key)</span></div><div class="token-line" style="color:var(--theme-ui-colors-plain-color)"><span class="token plain">flattened_value = layers.Reshape((-1, 3))(value)</span></div><div class="token-line" style="color:var(--theme-ui-colors-plain-color)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:var(--theme-ui-colors-plain-color)"><span class="token plain">print(&quot;Flattened Query shape:&quot;, flattened_query.shape)</span></div><div class="token-line" style="color:var(--theme-ui-colors-plain-color)"><span class="token plain">print(&quot;Flattened Key shape:&quot;, flattened_key.shape)</span></div><div class="token-line" style="color:var(--theme-ui-colors-plain-color)"><span class="token plain">print(&quot;Flattened Value shape:&quot;, flattened_value.shape)</span></div><div class="token-line" style="color:var(--theme-ui-colors-plain-color)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:var(--theme-ui-colors-plain-color)"><span class="token plain"># Transpose the flattened_key</span></div><div class="token-line" style="color:var(--theme-ui-colors-plain-color)"><span class="token plain">transposed_key = layers.Lambda(lambda x: tf.transpose(x, perm=[0, 2, 1]))(flattened_key)</span></div><div class="token-line" style="color:var(--theme-ui-colors-plain-color)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:var(--theme-ui-colors-plain-color)"><span class="token plain"># Print the shape of the transposed_key</span></div><div class="token-line" style="color:var(--theme-ui-colors-plain-color)"><span class="token plain">print(&quot;Transposed Key shape:&quot;, transposed_key.shape)</span></div><div class="token-line" style="color:var(--theme-ui-colors-plain-color)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:var(--theme-ui-colors-plain-color)"><span class="token plain"># Compute the dot product between the query and the key and scale it</span></div><div class="token-line" style="color:var(--theme-ui-colors-plain-color)"><span class="token plain">scaled_prod = layers.Dot(axes=(2,1))([flattened_query, transposed_key]) / tf.math.sqrt(tf.cast(dk, tf.float32))</span></div><div class="token-line" style="color:var(--theme-ui-colors-plain-color)"><span class="token plain">print(&quot;Dot Product shape:&quot;, prod.shape)</span></div><div class="token-line" style="color:var(--theme-ui-colors-plain-color)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:var(--theme-ui-colors-plain-color)"><span class="token plain"># Apply softmax to the attention scores</span></div><div class="token-line" style="color:var(--theme-ui-colors-plain-color)"><span class="token plain">softmax_layer = layers.Softmax()(scaled_prod)</span></div><div class="token-line" style="color:var(--theme-ui-colors-plain-color)"><span class="token plain">print(&quot;Softmax shape:&quot;, softmax_layer.shape)</span></div><div class="token-line" style="color:var(--theme-ui-colors-plain-color)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:var(--theme-ui-colors-plain-color)"><span class="token plain"># Compute the attention-weighted value</span></div><div class="token-line" style="color:var(--theme-ui-colors-plain-color)"><span class="token plain">attention_output = layers.Dot(axes=1)([softmax_layer, flattened_value])</span></div><div class="token-line" style="color:var(--theme-ui-colors-plain-color)"><span class="token plain">print(&quot;Attention Output shape:&quot;, attention_output.shape)</span></div><div class="token-line" style="color:var(--theme-ui-colors-plain-color)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:var(--theme-ui-colors-plain-color)"><span class="token plain">reshaped_attention_output = layers.Reshape((feature_dimension))(attention_output)</span></div><div class="token-line" style="color:var(--theme-ui-colors-plain-color)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:var(--theme-ui-colors-plain-color)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:var(--theme-ui-colors-plain-color)"><span class="token plain"># # Reshape the attention output to match the original image dimensions</span></div><div class="token-line" style="color:var(--theme-ui-colors-plain-color)"><span class="token plain"># reshaped_attention_output = layers.Reshape((32, 32, 3))(attention_output)</span></div><div class="token-line" style="color:var(--theme-ui-colors-plain-color)"><span class="token plain">print(&quot;Reshaped Attention Output shape:&quot;, reshaped_attention_output.shape)</span></div><div class="token-line" style="color:var(--theme-ui-colors-plain-color)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:var(--theme-ui-colors-plain-color)"><span class="token plain"># Apply a 1x1 convolutional layer to the attention output</span></div><div class="token-line" style="color:var(--theme-ui-colors-plain-color)"><span class="token plain">self_attended_feature = layers.Conv2D(filters=3, kernel_size=(1, 1), activation=&#x27;relu&#x27;, padding=&#x27;same&#x27;, </span></div><div class="token-line" style="color:var(--theme-ui-colors-plain-color)"><span class="token plain">                                      name=&quot;feature_map&quot;)(reshaped_attention_output)</span></div><div class="token-line" style="color:var(--theme-ui-colors-plain-color)"><span class="token plain">print(&quot;Self-attended Feature shape:&quot;, self_attended_feature.shape)</span></div></code></pre></div>
<h2 class="css-1h962gv">Use of Tensorflow <code class="css-zezy6m">tf.keras.layers.MultiHeadAttention</code> API</h2>
<p class="css-z0logh">If you are using Tensoflow then, you may use <code class="css-zezy6m">tf.keras.layers.MultiHeadAttention</code> this API to use the multihead attention directly. If <code class="css-zezy6m">query</code>, <code class="css-zezy6m">key</code>, <code class="css-zezy6m">value</code> are the same, then this is self-attention <sup><a href="#user-content-fn-4" id="user-content-fnref-4" data-footnote-ref="true" aria-describedby="footnote-label" class="css-1diwg7s">4</a></sup>. Each timestep in query attends to the corresponding sequence in <code class="css-zezy6m">key</code>, and returns a fixed-width vector.</p>
<p class="css-z0logh">This layer first projects <code class="css-zezy6m">query</code>, <code class="css-zezy6m">key</code> and <code class="css-zezy6m">value</code>. These are (effectively) a list of tensors of length <code class="css-zezy6m">num_attention_heads</code>, where the corresponding shapes are (<code class="css-zezy6m">batch_size</code>, <code class="css-zezy6m">&lt;query dimensions&gt;</code>, <code class="css-zezy6m">key_dim</code>), (<code class="css-zezy6m">batch_size</code>, <code class="css-zezy6m">&lt;key/value dimensions&gt;</code>, <code class="css-zezy6m">key_dim</code>), (<code class="css-zezy6m">batch_size</code>, <code class="css-zezy6m">&lt;key/value dimensions&gt;</code>, <code class="css-zezy6m">value_dim</code>).</p>
<p class="css-z0logh">Then, the query and key tensors are dot-producted and scaled. These are softmaxed to obtain attention probabilities. The value tensors are then interpolated by these probabilities, then concatenated back to a single tensor. Finally, the result tensor with the last dimension as value_dim can take a linear projection and return.</p>
<div class="gatsby-highlight" data-language="python:title=multihead_attention_model.py"><pre class="prism-code language-python:title=multihead_attention_model.py" data-linenumber="false"><button type="button" name="copy code to clipboard" class="code-copy-button css-ce1lkk">Copy<span aria-roledescription="status" class="css-15vf505">copy code to clipboard</span></button><code class="code-content language-python:title=multihead_attention_model.py"><div class="token-line" style="color:var(--theme-ui-colors-plain-color)"><span class="token plain">self_attended_feature = layers.MultiHeadAttention(num_heads=1, key_dim=3, value_dim = 3)(resnet50_base.output, resnet50_base.output)</span></div></code></pre></div>
<p class="css-z0logh">The comparison between both the models can be seen in the below figure.
<span><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; "
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 40.416666666666664%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAABJ0AAASdAHeZh94AAABR0lEQVR42pVR2XKDMBDj/7+yySRgfK5PrgRVkGmax9YzOxjYlbRSNxoL5yMkFWiJcMkj54JSC6w36PseSius24q/nG5QI5QrmNoEHRMkRzTe2zTBOA2lBqScCLi9h/Z9fz9/7m9AYxxCLKh1orqMWCLvDfM8wzuHr9uFBA21VYzawgt72OuLnFtMJHbBYSCxpIBOc2UbMlJpsFQYqLCUSoBGKywbFRuFNiRcew1DwEBinwWtVuSaoYzC7X6DRAIaSw+lnkw2H+zpXHleqJDMR+OphN+M0QjFkyBiXVc8n09srMfjcdbxzpUNtM9UNMMxjETGw7+ZA048LvcrCtc9AJZlOcNZCfjkNjQXlA6i/Xo4jgzFBkT+tDFydYKzuXLIMd1xeIWyfYSCI4ijqOisj2A6EWGygjQTpJRXclS405+dXlIa/nO+AdSnavfg7sY3AAAAAElFTkSuQmCC'); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="attention 4"
        title=""
        src="/static/0df7fd6cb7a86333f53b0b10f85f6633/7d769/attention-4.png"
        srcset="/static/0df7fd6cb7a86333f53b0b10f85f6633/5243c/attention-4.png 240w,
/static/0df7fd6cb7a86333f53b0b10f85f6633/ab158/attention-4.png 480w,
/static/0df7fd6cb7a86333f53b0b10f85f6633/7d769/attention-4.png 960w,
/static/0df7fd6cb7a86333f53b0b10f85f6633/87339/attention-4.png 1440w,
/static/0df7fd6cb7a86333f53b0b10f85f6633/faabe/attention-4.png 1509w"
        sizes="(max-width: 960px) 100vw, 960px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
        decoding="async"
      />
    </span></span></p>
<h2 class="css-1h962gv">Multi Head Attention</h2>
<p class="css-z0logh">When the number of head is one and the query, key and value dimensions are same then same network becomes self attention. But when we use multiple heads then the same network (key, query and value) gets multiplied with the number of heads and produce those many feature maps. Let&#x27;s take the same example and extend it for the multiple heads.
<span><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 904px; "
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 160.41666666666669%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAgCAYAAAASYli2AAAACXBIWXMAABJ0AAASdAHeZh94AAAEfElEQVR42pVW2ZLbNhAkwPuQeFOkSGm18h7ybioVJ///bZ2eAWV55XXFeUARBIFGz6DRQ8/zPLhmXDMWt7H/0Yxx7Tpgogi2rOF3A/y2h1+38HeTG6sa2LyA37T63aY5TJwogIli2M0WlvNNGK6A8iFJYbLcfSzYCOKXFd9LPmsd08240OYbfZo4dWSShP34ytYB+m23gm1gCawLpV+4MVlkt5Vu6jedRmHT7LPwXUd2NUmmoVgy01AEjKFKiMHyAL/fudD7UZnfcv8JoADIzoa7ClMTOUaaP4YcDKPO+Y0DWjvWurAIKMm1WaG5E1bXg9K81p1uJAwlFfJtPd07wLvm8paSYe3AFHxUUNlMI5FDZAqM9T8BDAIE0+J2HffuKfIRqdSNspUNgvmIYLfXtKi0GEH4cNb1P4V8FbXu6PsMPXCSoEaNLOC4HhJD1jD5bjhP194uiHGnSfoqCbKx21L77r3T79ofJgTjrEoI5dSZDjl9DZ06XLXoOepywpRNsD9oGAGTHRBAQg/GiYCZA5hmp88NpVWUmhLbc97AdJXtGnIYscXuxoj62bdytSTUlEnPSqcCfjPplvN8BLGPuCTzMEOaBNg2BQJq2TMEDDOGUBRcFCGMfCSV6JATA4tdl2LTbRHFGc5ziflQEajFcahwmjbI2wbHacL7uUfV1/A2BPsyd9gvNaKiwsNQ42kpUXYN9tMe719OOB07dFTA6/kJl8cR8+MZl8s7Xh9m7I8THh6f8XI+Ylmoyb7v8fXyFU+HHXbLjJeXr/jjcka/6zDOB1xeXwg4oh0GHJYDJrKoyWqeZ4xDh+1mA8FoqgrbLUPO8xzHAycOLQqGPZH+0LYo+TFiDtM0RSzWxhwmImaRDvvXpjK7eaHk2iKkxmTQ8KLLu/bXd6dNGTcIfN4ge3ejDAHv77IINdgv6JIJZ2/GuY5xGiz6bESWHeBVbygZ4vubh7Y1KysPjc9DY6v9u7sc0JnjP//BrjjhL+8Fb12O19nDfnNAkSzwum8oD4/4+5uHfrgBzqHFK+UzBnc3RcQZvb4T8IGAz3iuc7wvBrt8hzSmqOs3JB0P7MnDsAJSb1gI+EyZCbD9kaFYUHR5Q5uOePIOOFYx5s6gSjokYUNtHVW0+73HQ7rl6xD6Cnji0/+QQ5qpn20QUthbr0DBSXnsITIpIp+3IygQBQmabQjfriEroMUbQz7eM9TTNSKHUB06aCaE/YKw43O3IJlPCBvafzt9ZyeAkruFTRjaXxms2hNNQOuKmKe4Dp9iZ/bmeQo4BMwz2+Ge4YdiLZNpFldD/fgj8EPfSEoMJrLL7X+VAPFIus1HwJ9bTtCOYMJUNJn++Ocg9qSlVICklEoRyl0REssXj7wartZl8U/WloRmnNLZQ88xvpXR0B2IOrdUP3lqGYhcCZASKndXcikOLSYbuyr5sQRcAaUA0d61QJXUHjcQplqout4BSBltutWxt/dAn+RQC9Ftkv49COv1d0RSoH2y8tvB1eSfQT/5LfuNXzcNmwVt/eP63v4FVqm9XVRLVNkAAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="attention 5"
        title=""
        src="/static/b929cb787bd7bd2e4cba485ca31f1a71/799c6/attention-5.png"
        srcset="/static/b929cb787bd7bd2e4cba485ca31f1a71/5243c/attention-5.png 240w,
/static/b929cb787bd7bd2e4cba485ca31f1a71/ab158/attention-5.png 480w,
/static/b929cb787bd7bd2e4cba485ca31f1a71/799c6/attention-5.png 904w"
        sizes="(max-width: 904px) 100vw, 904px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
        decoding="async"
      />
    </span></span></p>
<h2 class="css-1h962gv">References</h2>
<section data-footnotes="true" class="footnotes"><h2 class="sr-only css-1h962gv" id="footnote-label">Footnotes</h2>
<ol class="css-15vy6y4">
<li id="user-content-fn-1" class="css-zezy6m">
<p class="css-z0logh">Vaswani, A., Shazeer, N., Parmar, N., Uszkoreit, J., Jones, L., Gomez, A. N., ... &amp; Polosukhin, I. (2017). Attention is all you need. Advances in neural information processing systems, 30. <a href="#user-content-fnref-1" data-footnote-backref="true" class="data-footnote-backref css-1diwg7s" aria-label="Back to content">↩</a> <a href="#user-content-fnref-1-2" data-footnote-backref="true" class="data-footnote-backref css-1diwg7s" aria-label="Back to content">↩<sup>2</sup></a></p>
</li>
<li id="user-content-fn-2" class="css-zezy6m">
<p class="css-z0logh"><a href="https://www.youtube.com/watch?v=mmzRYGCfTzc" class="css-1diwg7s">https://www.youtube.com/watch?v=mmzRYGCfTzc</a> <a href="#user-content-fnref-2" data-footnote-backref="true" class="data-footnote-backref css-1diwg7s" aria-label="Back to content">↩</a></p>
</li>
<li id="user-content-fn-3" class="css-zezy6m">
<p class="css-z0logh"><a href="https://www.youtube.com/watch?v=WyuZvGt7RY4&amp;t=2207s" class="css-1diwg7s">https://www.youtube.com/watch?v=WyuZvGt7RY4&amp;t=2207s</a> <a href="#user-content-fnref-3" data-footnote-backref="true" class="data-footnote-backref css-1diwg7s" aria-label="Back to content">↩</a></p>
</li>
<li id="user-content-fn-4" class="css-zezy6m">
<p class="css-z0logh"><a href="https://www.tensorflow.org/api_docs/python/tf/keras/layers/MultiHeadAttention" class="css-1diwg7s">https://www.tensorflow.org/api_docs/python/tf/keras/layers/MultiHeadAttention</a> <a href="#user-content-fnref-4" data-footnote-backref="true" class="data-footnote-backref css-1diwg7s" aria-label="Back to content">↩</a></p>
</li>
</ol>
</section></section></main><style data-emotion="css y7pay1">.css-y7pay1{box-sizing:border-box;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;margin-top:8rem;color:var(--theme-ui-colors-secondary);-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;border-top-style:solid;border-top-width:1px;border-top-color:var(--theme-ui-colors-divide);padding-top:1rem;}.css-y7pay1 a{color:var(--theme-ui-colors-secondary);-webkit-text-decoration:none;text-decoration:none;}.css-y7pay1 a:hover{color:var(--theme-ui-colors-heading);-webkit-text-decoration:underline;text-decoration:underline;}.css-y7pay1 a:focus{color:var(--theme-ui-colors-heading);}@media screen and (min-width: 640px){.css-y7pay1{-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}}@media screen and (min-width: 768px){.css-y7pay1{-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;}}</style><footer class="css-y7pay1"><div>© <!-- -->2024<!-- --> by <!-- -->Robaita<!-- -->. All rights reserved.</div><div><a aria-label="Link to the theme&#x27;s GitHub repository" href="https://github.com/LekoArts/gatsby-themes/tree/main/themes/gatsby-theme-minimal-blog" class="css-aizfxq">Theme</a> <!-- -->by<!-- --> <a aria-label="Link to the theme author&#x27;s website" href="https://www.lekoarts.de?utm_source=minimal-blog&amp;utm_medium=Theme" class="css-aizfxq">LekoArts</a></div></footer></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/blog/attention/";/*]]>*/</script><!-- slice-start id="_gatsby-scripts-1" -->
          <script
            id="gatsby-chunk-mapping"
          >
            window.___chunkMapping="{\"app\":[\"/app-3af181635fec5e571c00.js\"],\"component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-blog-query-tsx\":[\"/component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-blog-query-tsx-48751bf5cbcee011d1a5.js\"],\"component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-homepage-query-tsx\":[\"/component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-homepage-query-tsx-a02c80e67659a2ae8e3b.js\"],\"component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-page-query-tsx-content-file-path-content-pages-about-index-mdx\":[\"/component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-page-query-tsx-content-file-path-content-pages-about-index-mdx-7f0bbacf2d8db88c49e7.js\"],\"component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-page-query-tsx-content-file-path-content-pages-ai-product-management-index-mdx\":[\"/component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-page-query-tsx-content-file-path-content-pages-ai-product-management-index-mdx-3e4e090c19f84c87ca51.js\"],\"component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-page-query-tsx-content-file-path-content-pages-art-index-mdx\":[\"/component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-page-query-tsx-content-file-path-content-pages-art-index-mdx-a46f7e8694ec2c9babd1.js\"],\"component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-page-query-tsx-content-file-path-content-pages-courses-index-mdx\":[\"/component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-page-query-tsx-content-file-path-content-pages-courses-index-mdx-45d7baf94d7c9c54faae.js\"],\"component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-page-query-tsx-content-file-path-content-pages-introduction-to-artificial-neural-network-index-mdx\":[\"/component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-page-query-tsx-content-file-path-content-pages-introduction-to-artificial-neural-network-index-mdx-50dcad6bfde6bc1bc3da.js\"],\"component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-page-query-tsx-content-file-path-content-pages-introduction-to-generative-ai-index-mdx\":[\"/component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-page-query-tsx-content-file-path-content-pages-introduction-to-generative-ai-index-mdx-f914a486443472cab299.js\"],\"component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-post-query-tsx-content-file-path-content-posts-ai-product-lifecycle-index-mdx\":[\"/component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-post-query-tsx-content-file-path-content-posts-ai-product-lifecycle-index-mdx-3fb9ff0eb090a7b49912.js\"],\"component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-post-query-tsx-content-file-path-content-posts-an-overview-of-generative-ai-index-mdx\":[\"/component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-post-query-tsx-content-file-path-content-posts-an-overview-of-generative-ai-index-mdx-358ce1d1492f99909160.js\"],\"component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-post-query-tsx-content-file-path-content-posts-attention-index-mdx\":[\"/component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-post-query-tsx-content-file-path-content-posts-attention-index-mdx-eb8400b49b4b88e0d573.js\"],\"component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-post-query-tsx-content-file-path-content-posts-breakdown-to-breakthrough-index-mdx\":[\"/component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-post-query-tsx-content-file-path-content-posts-breakdown-to-breakthrough-index-mdx-7d3cbd5e324ad3808b68.js\"],\"component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-post-query-tsx-content-file-path-content-posts-finance-llm-index-mdx\":[\"/component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-post-query-tsx-content-file-path-content-posts-finance-llm-index-mdx-383bc4992359202d5cac.js\"],\"component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-post-query-tsx-content-file-path-content-posts-how-to-write-a-cover-letter-index-mdx\":[\"/component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-post-query-tsx-content-file-path-content-posts-how-to-write-a-cover-letter-index-mdx-936f07feb6f6c8f1fcd8.js\"],\"component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-post-query-tsx-content-file-path-content-posts-introduction-to-ai-product-management-index-mdx\":[\"/component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-post-query-tsx-content-file-path-content-posts-introduction-to-ai-product-management-index-mdx-a04edb0218ea4385c86c.js\"],\"component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-post-query-tsx-content-file-path-content-posts-one-x-one-convolution-index-mdx\":[\"/component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-post-query-tsx-content-file-path-content-posts-one-x-one-convolution-index-mdx-f07489ef46f7049cf7c8.js\"],\"component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-post-query-tsx-content-file-path-content-posts-star-methodology-index-mdx\":[\"/component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-post-query-tsx-content-file-path-content-posts-star-methodology-index-mdx-f1741c3d3924179e2bd8.js\"],\"component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-tag-query-tsx\":[\"/component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-tag-query-tsx-71b784c39ba22f6fd78f.js\"],\"component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-tags-query-tsx\":[\"/component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-tags-query-tsx-443eabf3ac878e5df724.js\"],\"component---src-pages-404-tsx\":[\"/component---src-pages-404-tsx-53c49be1a22e70f393e7.js\"]}";
          </script>
        <script>window.___webpackCompilationHash="eba8e9f4a3b4a4042825";</script><script src="/webpack-runtime-39343c4cba59fe236220.js" async></script><script src="/framework-7a7eba75d9b3bcf2ea27.js" async></script><script src="/app-3af181635fec5e571c00.js" async></script><!-- slice-end id="_gatsby-scripts-1" --></body></html>